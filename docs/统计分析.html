<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 7 章 统计分析 | Cookbook for R 中文版</title>
  <meta name="description" content="第 7 章 统计分析 | Cookbook for R 中文版本" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="第 7 章 统计分析 | Cookbook for R 中文版" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="第 7 章 统计分析 | Cookbook for R 中文版本" />
  <meta name="github-repo" content="openbiox/Cookbook-for-R-Chinese" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 7 章 统计分析 | Cookbook for R 中文版" />
  
  <meta name="twitter:description" content="第 7 章 统计分析 | Cookbook for R 中文版本" />
  

<meta name="author" content="Winston Chang（著）" />
<meta name="author" content="王诗翔 等（译）" />


<meta name="date" content="2021-08-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="数据操作.html"/>
<link rel="next" href="标准绘图.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Cookbook for R 中文版</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#问题与反馈"><i class="fa fa-check"></i><b>0.1</b> 问题与反馈</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#致谢"><i class="fa fa-check"></i><b>0.2</b> 致谢</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> 基础</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#r-pkg-installation"><i class="fa fa-check"></i><b>1.1</b> 安装和使用 R 包</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#数据结构的索引"><i class="fa fa-check"></i><b>1.2</b> 数据结构的索引</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#获取数据结构的子集"><i class="fa fa-check"></i><b>1.3</b> 获取数据结构的子集</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#创建填满值的向量"><i class="fa fa-check"></i><b>1.4</b> 创建填满值的向量</a></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#变量信息"><i class="fa fa-check"></i><b>1.5</b> 变量信息</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#nullnanan-的处理"><i class="fa fa-check"></i><b>1.6</b> NULL、NA、NaN 的处理</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="数字.html"><a href="数字.html"><i class="fa fa-check"></i><b>2</b> 数字</a>
<ul>
<li class="chapter" data-level="2.1" data-path="数字.html"><a href="数字.html#生成随机数"><i class="fa fa-check"></i><b>2.1</b> 生成随机数</a></li>
<li class="chapter" data-level="2.2" data-path="数字.html"><a href="数字.html#生成可重复的随机序列"><i class="fa fa-check"></i><b>2.2</b> 生成可重复的随机序列</a></li>
<li class="chapter" data-level="2.3" data-path="数字.html"><a href="数字.html#保持随机数生成器的状态"><i class="fa fa-check"></i><b>2.3</b> 保持随机数生成器的状态</a></li>
<li class="chapter" data-level="2.4" data-path="数字.html"><a href="数字.html#对数值取整"><i class="fa fa-check"></i><b>2.4</b> 对数值取整</a></li>
<li class="chapter" data-level="2.5" data-path="数字.html"><a href="数字.html#比较浮点数"><i class="fa fa-check"></i><b>2.5</b> 比较浮点数</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="字符串.html"><a href="字符串.html"><i class="fa fa-check"></i><b>3</b> 字符串</a>
<ul>
<li class="chapter" data-level="3.1" data-path="字符串.html"><a href="字符串.html#使用-grepsubgsub-进行搜索和替换"><i class="fa fa-check"></i><b>3.1</b> 使用 grep、sub、gsub 进行搜索和替换</a></li>
<li class="chapter" data-level="3.2" data-path="字符串.html"><a href="字符串.html#通过变量创建字符串"><i class="fa fa-check"></i><b>3.2</b> 通过变量创建字符串</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="公式.html"><a href="公式.html"><i class="fa fa-check"></i><b>4</b> 公式</a>
<ul>
<li class="chapter" data-level="4.1" data-path="公式.html"><a href="公式.html#通过字符串创建公式"><i class="fa fa-check"></i><b>4.1</b> 通过字符串创建公式</a></li>
<li class="chapter" data-level="4.2" data-path="公式.html"><a href="公式.html#从公式中提取组分"><i class="fa fa-check"></i><b>4.2</b> 从公式中提取组分</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="数据的导入与导出.html"><a href="数据的导入与导出.html"><i class="fa fa-check"></i><b>5</b> 数据的导入与导出</a>
<ul>
<li class="chapter" data-level="5.1" data-path="数据的导入与导出.html"><a href="数据的导入与导出.html#r-import-data-from-file"><i class="fa fa-check"></i><b>5.1</b> R载入文件中的数据</a></li>
<li class="chapter" data-level="5.2" data-path="数据的导入与导出.html"><a href="数据的导入与导出.html#read-data-from-keyboard"><i class="fa fa-check"></i><b>5.2</b> 通过键盘和剪贴板把数据载入并保存到 R</a></li>
<li class="chapter" data-level="5.3" data-path="数据的导入与导出.html"><a href="数据的导入与导出.html#run-r-script"><i class="fa fa-check"></i><b>5.3</b> 运行 R 脚本</a></li>
<li class="chapter" data-level="5.4" data-path="数据的导入与导出.html"><a href="数据的导入与导出.html#r-write-data-into-file"><i class="fa fa-check"></i><b>5.4</b> 用 R 把数据写入文件</a></li>
<li class="chapter" data-level="5.5" data-path="数据的导入与导出.html"><a href="数据的导入与导出.html#r-output-analysis"><i class="fa fa-check"></i><b>5.5</b> 用 R 写入文本，分析输出到文件</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="数据操作.html"><a href="数据操作.html"><i class="fa fa-check"></i><b>6</b> 数据操作</a>
<ul>
<li class="chapter" data-level="6.1" data-path="数据操作.html"><a href="数据操作.html#排序"><i class="fa fa-check"></i><b>6.1</b> 排序</a></li>
<li class="chapter" data-level="6.2" data-path="数据操作.html"><a href="数据操作.html#随机排序"><i class="fa fa-check"></i><b>6.2</b> 随机排序</a></li>
<li class="chapter" data-level="6.3" data-path="数据操作.html"><a href="数据操作.html#转换向量类型"><i class="fa fa-check"></i><b>6.3</b> 转换向量类型</a></li>
<li class="chapter" data-level="6.4" data-path="数据操作.html"><a href="数据操作.html#查找并移除重复记录"><i class="fa fa-check"></i><b>6.4</b> 查找并移除重复记录</a></li>
<li class="chapter" data-level="6.5" data-path="数据操作.html"><a href="数据操作.html#compare-with-nas"><i class="fa fa-check"></i><b>6.5</b> NA 存在时进行向量或因子比较</a></li>
<li class="chapter" data-level="6.6" data-path="数据操作.html"><a href="数据操作.html#数据重新编码"><i class="fa fa-check"></i><b>6.6</b> 数据重新编码</a></li>
<li class="chapter" data-level="6.7" data-path="数据操作.html"><a href="数据操作.html#映射向量值"><i class="fa fa-check"></i><b>6.7</b> 映射向量值</a></li>
<li class="chapter" data-level="6.8" data-path="数据操作.html"><a href="数据操作.html#重命名因子水平"><i class="fa fa-check"></i><b>6.8</b> 重命名因子水平</a></li>
<li class="chapter" data-level="6.9" data-path="数据操作.html"><a href="数据操作.html#重计算因子水平"><i class="fa fa-check"></i><b>6.9</b> 重计算因子水平</a></li>
<li class="chapter" data-level="6.10" data-path="数据操作.html"><a href="数据操作.html#改变因子水平次序"><i class="fa fa-check"></i><b>6.10</b> 改变因子水平次序</a></li>
<li class="chapter" data-level="6.11" data-path="数据操作.html"><a href="数据操作.html#重命名数据框的列"><i class="fa fa-check"></i><b>6.11</b> 重命名数据框的列</a></li>
<li class="chapter" data-level="6.12" data-path="数据操作.html"><a href="数据操作.html#添加和移除数据框的列"><i class="fa fa-check"></i><b>6.12</b> 添加和移除数据框的列</a></li>
<li class="chapter" data-level="6.13" data-path="数据操作.html"><a href="数据操作.html#对数据框的列重新排序"><i class="fa fa-check"></i><b>6.13</b> 对数据框的列重新排序</a></li>
<li class="chapter" data-level="6.14" data-path="数据操作.html"><a href="数据操作.html#合并数据框"><i class="fa fa-check"></i><b>6.14</b> 合并数据框</a></li>
<li class="chapter" data-level="6.15" data-path="数据操作.html"><a href="数据操作.html#比较数据框"><i class="fa fa-check"></i><b>6.15</b> 比较数据框</a></li>
<li class="chapter" data-level="6.16" data-path="数据操作.html"><a href="数据操作.html#重计算数据框所有因子列的水平"><i class="fa fa-check"></i><b>6.16</b> 重计算数据框所有因子列的水平</a></li>
<li class="chapter" data-level="6.17" data-path="数据操作.html"><a href="数据操作.html#长宽格式数据互换"><i class="fa fa-check"></i><b>6.17</b> 长宽格式数据互换</a></li>
<li class="chapter" data-level="6.18" data-path="数据操作.html"><a href="数据操作.html#汇总数据"><i class="fa fa-check"></i><b>6.18</b> 汇总数据</a></li>
<li class="chapter" data-level="6.19" data-path="数据操作.html"><a href="数据操作.html#数据框与列联表互换"><i class="fa fa-check"></i><b>6.19</b> 数据框与列联表互换</a></li>
<li class="chapter" data-level="6.20" data-path="数据操作.html"><a href="数据操作.html#计算移动平均数"><i class="fa fa-check"></i><b>6.20</b> 计算移动平均数</a></li>
<li class="chapter" data-level="6.21" data-path="数据操作.html"><a href="数据操作.html#窗口平滑"><i class="fa fa-check"></i><b>6.21</b> 窗口平滑</a></li>
<li class="chapter" data-level="6.22" data-path="数据操作.html"><a href="数据操作.html#寻找唯一值序列"><i class="fa fa-check"></i><b>6.22</b> 寻找唯一值序列</a></li>
<li class="chapter" data-level="6.23" data-path="数据操作.html"><a href="数据操作.html#fill-na-with-last-value"><i class="fa fa-check"></i><b>6.23</b> 用最后一个非 NA 值填充 NA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="统计分析.html"><a href="统计分析.html"><i class="fa fa-check"></i><b>7</b> 统计分析</a>
<ul>
<li class="chapter" data-level="7.1" data-path="统计分析.html"><a href="统计分析.html#回归和相关分析"><i class="fa fa-check"></i><b>7.1</b> 回归和相关分析</a></li>
<li class="chapter" data-level="7.2" data-path="统计分析.html"><a href="统计分析.html#t-检验"><i class="fa fa-check"></i><b>7.2</b> t 检验</a></li>
<li class="chapter" data-level="7.3" data-path="统计分析.html"><a href="统计分析.html#频率检验"><i class="fa fa-check"></i><b>7.3</b> 频率检验</a></li>
<li class="chapter" data-level="7.4" data-path="统计分析.html"><a href="统计分析.html#anova"><i class="fa fa-check"></i><b>7.4</b> ANOVA</a></li>
<li class="chapter" data-level="7.5" data-path="统计分析.html"><a href="统计分析.html#逻辑回归"><i class="fa fa-check"></i><b>7.5</b> 逻辑回归</a></li>
<li class="chapter" data-level="7.6" data-path="统计分析.html"><a href="统计分析.html#变量同质性"><i class="fa fa-check"></i><b>7.6</b> 变量同质性</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="标准绘图.html"><a href="标准绘图.html"><i class="fa fa-check"></i><b>8</b> 标准绘图</a>
<ul>
<li class="chapter" data-level="8.1" data-path="标准绘图.html"><a href="标准绘图.html#直方图和密度图"><i class="fa fa-check"></i><b>8.1</b> 直方图和密度图</a></li>
<li class="chapter" data-level="8.2" data-path="标准绘图.html"><a href="标准绘图.html#散点图"><i class="fa fa-check"></i><b>8.2</b> 散点图</a></li>
<li class="chapter" data-level="8.3" data-path="标准绘图.html"><a href="标准绘图.html#箱线图"><i class="fa fa-check"></i><b>8.3</b> 箱线图</a></li>
<li class="chapter" data-level="8.4" data-path="标准绘图.html"><a href="标准绘图.html#qq-plot"><i class="fa fa-check"></i><b>8.4</b> QQ 图</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>9</b> ggplot2</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ggplot2.html"><a href="ggplot2.html#条形图与线图"><i class="fa fa-check"></i><b>9.1</b> 条形图与线图</a></li>
<li class="chapter" data-level="9.2" data-path="ggplot2.html"><a href="ggplot2.html#绘制均值和误差线"><i class="fa fa-check"></i><b>9.2</b> 绘制均值和误差线</a></li>
<li class="chapter" data-level="9.3" data-path="ggplot2.html"><a href="ggplot2.html#分布图"><i class="fa fa-check"></i><b>9.3</b> 分布图</a></li>
<li class="chapter" data-level="9.4" data-path="ggplot2.html"><a href="ggplot2.html#散点图-1"><i class="fa fa-check"></i><b>9.4</b> 散点图</a></li>
<li class="chapter" data-level="9.5" data-path="ggplot2.html"><a href="ggplot2.html#标题"><i class="fa fa-check"></i><b>9.5</b> 标题</a></li>
<li class="chapter" data-level="9.6" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-axes"><i class="fa fa-check"></i><b>9.6</b> 坐标轴</a></li>
<li class="chapter" data-level="9.7" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-legends"><i class="fa fa-check"></i><b>9.7</b> 图例</a></li>
<li class="chapter" data-level="9.8" data-path="ggplot2.html"><a href="ggplot2.html#线条"><i class="fa fa-check"></i><b>9.8</b> 线条</a></li>
<li class="chapter" data-level="9.9" data-path="ggplot2.html"><a href="ggplot2.html#ggplot-facet"><i class="fa fa-check"></i><b>9.9</b> 分面</a></li>
<li class="chapter" data-level="9.10" data-path="ggplot2.html"><a href="ggplot2.html#多图"><i class="fa fa-check"></i><b>9.10</b> 多图</a></li>
<li class="chapter" data-level="9.11" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-colors"><i class="fa fa-check"></i><b>9.11</b> 颜色</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="图形混杂.html"><a href="图形混杂.html"><i class="fa fa-check"></i><b>10</b> 图形混杂</a>
<ul>
<li class="chapter" data-level="10.1" data-path="图形混杂.html"><a href="图形混杂.html#输出到文件-pdf-png-tiff-svg"><i class="fa fa-check"></i><b>10.1</b> 输出到文件 PDF-PNG-TIFF-SVG</a></li>
<li class="chapter" data-level="10.2" data-path="图形混杂.html"><a href="图形混杂.html#shape-and-linetype"><i class="fa fa-check"></i><b>10.2</b> 形状和线形</a></li>
<li class="chapter" data-level="10.3" data-path="图形混杂.html"><a href="图形混杂.html#字体"><i class="fa fa-check"></i><b>10.3</b> 字体</a></li>
<li class="chapter" data-level="10.4" data-path="图形混杂.html"><a href="图形混杂.html#抗混淆位图输出"><i class="fa fa-check"></i><b>10.4</b> 抗混淆位图输出</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="其他有趣图形.html"><a href="其他有趣图形.html"><i class="fa fa-check"></i><b>11</b> 其他有趣图形</a>
<ul>
<li class="chapter" data-level="11.1" data-path="其他有趣图形.html"><a href="其他有趣图形.html#corr-mat"><i class="fa fa-check"></i><b>11.1</b> 相关矩阵</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="脚本与函数.html"><a href="脚本与函数.html"><i class="fa fa-check"></i><b>12</b> 脚本与函数</a>
<ul>
<li class="chapter" data-level="12.1" data-path="脚本与函数.html"><a href="脚本与函数.html#创建和运行一个脚本"><i class="fa fa-check"></i><b>12.1</b> 创建和运行一个脚本</a></li>
<li class="chapter" data-level="12.2" data-path="脚本与函数.html"><a href="脚本与函数.html#调试脚本或函数"><i class="fa fa-check"></i><b>12.2</b> 调试脚本或函数</a></li>
<li class="chapter" data-level="12.3" data-path="脚本与函数.html"><a href="脚本与函数.html#测量运行的时间"><i class="fa fa-check"></i><b>12.3</b> 测量运行的时间</a></li>
<li class="chapter" data-level="12.4" data-path="脚本与函数.html"><a href="脚本与函数.html#获取包中的函数和对象列表"><i class="fa fa-check"></i><b>12.4</b> 获取包中的函数和对象列表</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="工具.html"><a href="工具.html"><i class="fa fa-check"></i><b>13</b> 工具</a>
<ul>
<li class="chapter" data-level="13.1" data-path="工具.html"><a href="工具.html#生成拉丁方"><i class="fa fa-check"></i><b>13.1</b> 生成拉丁方</a></li>
</ul></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="A" data-path="materials.html"><a href="materials.html"><i class="fa fa-check"></i><b>A</b> 资料推荐</a>
<ul>
<li class="chapter" data-level="A.1" data-path="materials.html"><a href="materials.html#书籍"><i class="fa fa-check"></i><b>A.1</b> 书籍</a></li>
<li class="chapter" data-level="A.2" data-path="materials.html"><a href="materials.html#r-包"><i class="fa fa-check"></i><b>A.2</b> R 包</a></li>
<li class="chapter" data-level="A.3" data-path="materials.html"><a href="materials.html#网站"><i class="fa fa-check"></i><b>A.3</b> 网站</a></li>
<li class="chapter" data-level="A.4" data-path="materials.html"><a href="materials.html#列表-2"><i class="fa fa-check"></i><b>A.4</b> 列表</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cookbook for R 中文版</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="统计分析" class="section level1" number="7">
<h1><span class="header-section-number">第 7 章</span> 统计分析</h1>
<div id="回归和相关分析" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> 回归和相关分析</h2>
<div id="问题-43" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> 问题</h3>
<p>你想要做线性回归或相关分析。</p>
</div>
<div id="方案-42" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> 方案</h3>
<p>要处理的一些样例数据：</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="统计分析.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 制造一些数据 X 增加（大的干扰噪声） Z 缓慢增加 构建</span></span>
<span id="cb187-2"><a href="统计分析.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Y，它与 X 变量负相关，与 X*Z 变量正相关</span></span>
<span id="cb187-3"><a href="统计分析.html#cb187-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">955</span>)</span>
<span id="cb187-4"><a href="统计分析.html#cb187-4" aria-hidden="true" tabindex="-1"></a>xvar <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb187-5"><a href="统计分析.html#cb187-5" aria-hidden="true" tabindex="-1"></a>zvar <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span><span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb187-6"><a href="统计分析.html#cb187-6" aria-hidden="true" tabindex="-1"></a>yvar <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> xvar <span class="sc">+</span> xvar <span class="sc">*</span> zvar<span class="sc">/</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb187-7"><a href="统计分析.html#cb187-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-8"><a href="统计分析.html#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 通过组合已创建的向量来构建数据框</span></span>
<span id="cb187-9"><a href="统计分析.html#cb187-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xvar, <span class="at">y =</span> yvar, <span class="at">z =</span> zvar)</span>
<span id="cb187-10"><a href="统计分析.html#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 展示前 6 行</span></span>
<span id="cb187-11"><a href="统计分析.html#cb187-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span>
<span id="cb187-12"><a href="统计分析.html#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        x       y        z</span></span>
<span id="cb187-13"><a href="统计分析.html#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -4.252   4.586  1.89877</span></span>
<span id="cb187-14"><a href="统计分析.html#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  1.702  -4.903 -0.82937</span></span>
<span id="cb187-15"><a href="统计分析.html#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  4.323  -4.308 -1.31283</span></span>
<span id="cb187-16"><a href="统计分析.html#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  1.781   0.205 -0.28479</span></span>
<span id="cb187-17"><a href="统计分析.html#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 11.537 -29.767 -1.27304</span></span>
<span id="cb187-18"><a href="统计分析.html#cb187-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  6.672 -10.146 -0.09459</span></span></code></pre></div>
<div id="相关系数" class="section level4" number="7.1.2.1">
<h4><span class="header-section-number">7.1.2.1</span> 相关系数</h4>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="统计分析.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 相关系数 - 默认使用 pearson 方法</span></span>
<span id="cb188-2"><a href="统计分析.html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dat<span class="sc">$</span>x, dat<span class="sc">$</span>y)</span>
<span id="cb188-3"><a href="统计分析.html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.7695</span></span></code></pre></div>
</div>
<div id="相关矩阵多个变量" class="section level4" number="7.1.2.2">
<h4><span class="header-section-number">7.1.2.2</span> 相关矩阵（多个变量）</h4>
<p>同时可以对多个变量进行两两相关性分析，结果是一个 nxn 的平方矩阵或是数据框。</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="统计分析.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 变量之间的相关矩阵</span></span>
<span id="cb189-2"><a href="统计分析.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dat)</span>
<span id="cb189-3"><a href="统计分析.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         x         y        z</span></span>
<span id="cb189-4"><a href="统计分析.html#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x  1.0000 -0.769538 0.491699</span></span>
<span id="cb189-5"><a href="统计分析.html#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y -0.7695  1.000000 0.004172</span></span>
<span id="cb189-6"><a href="统计分析.html#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z  0.4917  0.004172 1.000000</span></span>
<span id="cb189-7"><a href="统计分析.html#cb189-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-8"><a href="统计分析.html#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 保留两位小数点</span></span>
<span id="cb189-9"><a href="统计分析.html#cb189-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(dat), <span class="dv">2</span>)</span>
<span id="cb189-10"><a href="统计分析.html#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       x     y    z</span></span>
<span id="cb189-11"><a href="统计分析.html#cb189-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x  1.00 -0.77 0.49</span></span>
<span id="cb189-12"><a href="统计分析.html#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y -0.77  1.00 0.00</span></span>
<span id="cb189-13"><a href="统计分析.html#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z  0.49  0.00 1.00</span></span></code></pre></div>
</div>
<div id="线性回归" class="section level4" number="7.1.2.3">
<h4><span class="header-section-number">7.1.2.3</span> 线性回归</h4>
<p>线性回归，当 <code>dat$x</code> 是预测变量时，<code>dat$y</code> 为响应变量。这可以使用一个数据框的两列，或者是直接使用数值向量。</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="统计分析.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 下面两个命令会显示一样的结果</span></span>
<span id="cb190-2"><a href="统计分析.html#cb190-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat)  <span class="co"># 使用数据框的 x 列和 y 列</span></span>
<span id="cb190-3"><a href="统计分析.html#cb190-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>y <span class="sc">~</span> dat<span class="sc">$</span>x)  <span class="co"># 使用 dat$x 和 dat$y 进行拟合</span></span>
<span id="cb190-4"><a href="统计分析.html#cb190-4" aria-hidden="true" tabindex="-1"></a>fit</span>
<span id="cb190-5"><a href="统计分析.html#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-6"><a href="统计分析.html#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb190-7"><a href="统计分析.html#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = dat$y ~ dat$x)</span></span>
<span id="cb190-8"><a href="统计分析.html#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-9"><a href="统计分析.html#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb190-10"><a href="统计分析.html#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        dat$x  </span></span>
<span id="cb190-11"><a href="统计分析.html#cb190-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      -0.228       -1.183</span></span>
<span id="cb190-12"><a href="统计分析.html#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="统计分析.html#cb190-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 这说明预测 y = -0.2278 - 1.1829*x 获取更详细的信息</span></span>
<span id="cb190-14"><a href="统计分析.html#cb190-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb190-15"><a href="统计分析.html#cb190-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-16"><a href="统计分析.html#cb190-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb190-17"><a href="统计分析.html#cb190-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = dat$y ~ dat$x)</span></span>
<span id="cb190-18"><a href="统计分析.html#cb190-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-19"><a href="统计分析.html#cb190-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb190-20"><a href="统计分析.html#cb190-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span id="cb190-21"><a href="统计分析.html#cb190-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -15.892  -2.511   0.287   4.465   9.329 </span></span>
<span id="cb190-22"><a href="统计分析.html#cb190-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-23"><a href="统计分析.html#cb190-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb190-24"><a href="统计分析.html#cb190-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb190-25"><a href="统计分析.html#cb190-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -0.228      2.632   -0.09     0.93    </span></span>
<span id="cb190-26"><a href="统计分析.html#cb190-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dat$x         -1.183      0.231   -5.11  7.3e-05 ***</span></span>
<span id="cb190-27"><a href="统计分析.html#cb190-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb190-28"><a href="统计分析.html#cb190-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb190-29"><a href="统计分析.html#cb190-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb190-30"><a href="统计分析.html#cb190-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb190-31"><a href="统计分析.html#cb190-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 6.51 on 18 degrees of freedom</span></span>
<span id="cb190-32"><a href="统计分析.html#cb190-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.592,  Adjusted R-squared:  0.57 </span></span>
<span id="cb190-33"><a href="统计分析.html#cb190-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 26.1 on 1 and 18 DF,  p-value: 7.28e-05</span></span></code></pre></div>
</div>
<div id="多个预测变量的线性回归多元线性回归" class="section level4" number="7.1.2.4">
<h4><span class="header-section-number">7.1.2.4</span> 多个预测变量的线性回归（多元线性回归）</h4>
<p>使用 <code>y</code> 作为线性回归的响应变量，<code>x</code> 和 <code>z</code> 作为预测变量。</p>
<p>注意下面的公式没有检测 <code>x</code> 与 <code>z</code> 之间的交互效应。</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="统计分析.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 这些都有相同的结果</span></span>
<span id="cb191-2"><a href="统计分析.html#cb191-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> z, <span class="at">data =</span> dat)  <span class="co"># 使用数据框的 x,y,z 列</span></span>
<span id="cb191-3"><a href="统计分析.html#cb191-3" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dat<span class="sc">$</span>y <span class="sc">~</span> dat<span class="sc">$</span>x <span class="sc">+</span> dat<span class="sc">$</span>z)  <span class="co"># 使用向量</span></span>
<span id="cb191-4"><a href="统计分析.html#cb191-4" aria-hidden="true" tabindex="-1"></a>fit2</span>
<span id="cb191-5"><a href="统计分析.html#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb191-6"><a href="统计分析.html#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb191-7"><a href="统计分析.html#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = dat$y ~ dat$x + dat$z)</span></span>
<span id="cb191-8"><a href="统计分析.html#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb191-9"><a href="统计分析.html#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb191-10"><a href="统计分析.html#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)        dat$x        dat$z  </span></span>
<span id="cb191-11"><a href="统计分析.html#cb191-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -1.38        -1.56         1.86</span></span>
<span id="cb191-12"><a href="统计分析.html#cb191-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-13"><a href="统计分析.html#cb191-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb191-14"><a href="统计分析.html#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb191-15"><a href="统计分析.html#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb191-16"><a href="统计分析.html#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = dat$y ~ dat$x + dat$z)</span></span>
<span id="cb191-17"><a href="统计分析.html#cb191-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb191-18"><a href="统计分析.html#cb191-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb191-19"><a href="统计分析.html#cb191-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb191-20"><a href="统计分析.html#cb191-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -7.97  -3.19  -1.21   3.85   7.52 </span></span>
<span id="cb191-21"><a href="统计分析.html#cb191-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb191-22"><a href="统计分析.html#cb191-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb191-23"><a href="统计分析.html#cb191-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb191-24"><a href="统计分析.html#cb191-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -1.382      1.988   -0.70   0.4964    </span></span>
<span id="cb191-25"><a href="统计分析.html#cb191-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dat$x         -1.564      0.198   -7.88  4.5e-07 ***</span></span>
<span id="cb191-26"><a href="统计分析.html#cb191-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; dat$z          1.858      0.475    3.91   0.0011 ** </span></span>
<span id="cb191-27"><a href="统计分析.html#cb191-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb191-28"><a href="统计分析.html#cb191-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb191-29"><a href="统计分析.html#cb191-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb191-30"><a href="统计分析.html#cb191-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb191-31"><a href="统计分析.html#cb191-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 4.86 on 17 degrees of freedom</span></span>
<span id="cb191-32"><a href="统计分析.html#cb191-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.785,  Adjusted R-squared:  0.76 </span></span>
<span id="cb191-33"><a href="统计分析.html#cb191-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 31.1 on 2 and 17 DF,  p-value: 2.1e-06</span></span></code></pre></div>
<div id="交互效应" class="section level5" number="7.1.2.4.1">
<h5><span class="header-section-number">7.1.2.4.1</span> 交互效应</h5>
<p>如何合适地构建多元线性回归并且检验交互效应非常复杂，这里不作讲述。这里我们仅仅用 <code>x</code> 和 <code>z</code> 变量以及它们之间的交互效应拟合模型。</p>
<p>想要构建 <code>x</code> 与 <code>z</code> 之间的交互效应模型，需要添加 <code>x:z</code> 项。我们也可以使用公式 <code>x*z</code> 来代表 <code>x+z+x:z</code> 。</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="统计分析.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 下面两个公式等效</span></span>
<span id="cb192-2"><a href="统计分析.html#cb192-2" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">*</span> z, <span class="at">data =</span> dat)</span>
<span id="cb192-3"><a href="统计分析.html#cb192-3" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> z <span class="sc">+</span> x<span class="sc">:</span>z, <span class="at">data =</span> dat)</span>
<span id="cb192-4"><a href="统计分析.html#cb192-4" aria-hidden="true" tabindex="-1"></a>fit3</span>
<span id="cb192-5"><a href="统计分析.html#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-6"><a href="统计分析.html#cb192-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb192-7"><a href="统计分析.html#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x + z + x:z, data = dat)</span></span>
<span id="cb192-8"><a href="统计分析.html#cb192-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-9"><a href="统计分析.html#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb192-10"><a href="统计分析.html#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)            x            z          x:z  </span></span>
<span id="cb192-11"><a href="统计分析.html#cb192-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       2.282       -2.131       -0.107        0.208</span></span>
<span id="cb192-12"><a href="统计分析.html#cb192-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-13"><a href="统计分析.html#cb192-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span>
<span id="cb192-14"><a href="统计分析.html#cb192-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-15"><a href="统计分析.html#cb192-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb192-16"><a href="统计分析.html#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; lm(formula = y ~ x + z + x:z, data = dat)</span></span>
<span id="cb192-17"><a href="统计分析.html#cb192-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-18"><a href="统计分析.html#cb192-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb192-19"><a href="统计分析.html#cb192-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span id="cb192-20"><a href="统计分析.html#cb192-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -5.305 -3.600  0.393  2.138  8.396 </span></span>
<span id="cb192-21"><a href="统计分析.html#cb192-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-22"><a href="统计分析.html#cb192-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb192-23"><a href="统计分析.html#cb192-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb192-24"><a href="统计分析.html#cb192-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   2.2820     2.2006    1.04    0.315    </span></span>
<span id="cb192-25"><a href="统计分析.html#cb192-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x            -2.1311     0.2741   -7.78    8e-07 ***</span></span>
<span id="cb192-26"><a href="统计分析.html#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; z            -0.1068     0.8482   -0.13    0.901    </span></span>
<span id="cb192-27"><a href="统计分析.html#cb192-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x:z           0.2081     0.0787    2.64    0.018 *  </span></span>
<span id="cb192-28"><a href="统计分析.html#cb192-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb192-29"><a href="统计分析.html#cb192-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb192-30"><a href="统计分析.html#cb192-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb192-31"><a href="统计分析.html#cb192-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb192-32"><a href="统计分析.html#cb192-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 4.18 on 16 degrees of freedom</span></span>
<span id="cb192-33"><a href="统计分析.html#cb192-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-squared:  0.85,   Adjusted R-squared:  0.822 </span></span>
<span id="cb192-34"><a href="统计分析.html#cb192-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 30.3 on 3 and 16 DF,  p-value: 7.76e-07</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="t-检验" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> t 检验</h2>
<div id="问题-44" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> 问题</h3>
<p>你想要检验来自两个总体的样本是否有不同的均值（显著性差异），或者检验从一个总体抽取的样本均值和理论均值有显著性差异。</p>
</div>
<div id="方案-43" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> 方案</h3>
<div id="样本数据" class="section level4" number="7.2.2.1">
<h4><span class="header-section-number">7.2.2.1</span> 样本数据</h4>
<p>我们将使用内置的 <code>sleep</code> 数据集。</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="统计分析.html#cb193-1" aria-hidden="true" tabindex="-1"></a>sleep</span>
<span id="cb193-2"><a href="统计分析.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    extra group ID</span></span>
<span id="cb193-3"><a href="统计分析.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    0.7     1  1</span></span>
<span id="cb193-4"><a href="统计分析.html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   -1.6     1  2</span></span>
<span id="cb193-5"><a href="统计分析.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   -0.2     1  3</span></span>
<span id="cb193-6"><a href="统计分析.html#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   -1.2     1  4</span></span>
<span id="cb193-7"><a href="统计分析.html#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   -0.1     1  5</span></span>
<span id="cb193-8"><a href="统计分析.html#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    3.4     1  6</span></span>
<span id="cb193-9"><a href="统计分析.html#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7    3.7     1  7</span></span>
<span id="cb193-10"><a href="统计分析.html#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8    0.8     1  8</span></span>
<span id="cb193-11"><a href="统计分析.html#cb193-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9    0.0     1  9</span></span>
<span id="cb193-12"><a href="统计分析.html#cb193-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10   2.0     1 10</span></span>
<span id="cb193-13"><a href="统计分析.html#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11   1.9     2  1</span></span>
<span id="cb193-14"><a href="统计分析.html#cb193-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12   0.8     2  2</span></span>
<span id="cb193-15"><a href="统计分析.html#cb193-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13   1.1     2  3</span></span>
<span id="cb193-16"><a href="统计分析.html#cb193-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14   0.1     2  4</span></span>
<span id="cb193-17"><a href="统计分析.html#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15  -0.1     2  5</span></span>
<span id="cb193-18"><a href="统计分析.html#cb193-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 16   4.4     2  6</span></span>
<span id="cb193-19"><a href="统计分析.html#cb193-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17   5.5     2  7</span></span>
<span id="cb193-20"><a href="统计分析.html#cb193-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 18   1.6     2  8</span></span>
<span id="cb193-21"><a href="统计分析.html#cb193-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19   4.6     2  9</span></span>
<span id="cb193-22"><a href="统计分析.html#cb193-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20   3.4     2 10</span></span></code></pre></div>
<p>我们将制造 <code>sleep</code> 数据的宽格式版本；下面我们将看看如何处理长格式和宽格式的数据。</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="统计分析.html#cb194-1" aria-hidden="true" tabindex="-1"></a>sleep_wide <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">group1 =</span> sleep<span class="sc">$</span>extra[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],</span>
<span id="cb194-2"><a href="统计分析.html#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">group2 =</span> sleep<span class="sc">$</span>extra[<span class="dv">11</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb194-3"><a href="统计分析.html#cb194-3" aria-hidden="true" tabindex="-1"></a>sleep_wide</span>
<span id="cb194-4"><a href="统计分析.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    ID group1 group2</span></span>
<span id="cb194-5"><a href="统计分析.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1   1    0.7    1.9</span></span>
<span id="cb194-6"><a href="统计分析.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2   2   -1.6    0.8</span></span>
<span id="cb194-7"><a href="统计分析.html#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3   3   -0.2    1.1</span></span>
<span id="cb194-8"><a href="统计分析.html#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4   4   -1.2    0.1</span></span>
<span id="cb194-9"><a href="统计分析.html#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5   5   -0.1   -0.1</span></span>
<span id="cb194-10"><a href="统计分析.html#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6   6    3.4    4.4</span></span>
<span id="cb194-11"><a href="统计分析.html#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7   7    3.7    5.5</span></span>
<span id="cb194-12"><a href="统计分析.html#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8   8    0.8    1.6</span></span>
<span id="cb194-13"><a href="统计分析.html#cb194-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9   9    0.0    4.6</span></span>
<span id="cb194-14"><a href="统计分析.html#cb194-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 10    2.0    3.4</span></span></code></pre></div>
</div>
<div id="比较两组独立双样本-t-检验" class="section level4" number="7.2.2.2">
<h4><span class="header-section-number">7.2.2.2</span> 比较两组：独立双样本 t 检验</h4>
<p>假设有两组独立样本（我们这里忽略ID变量）。</p>
<p><code>t.test()</code> 函数能够操作像 <code>sleep</code> 这样的长格式数据——一列记录测量值，一列指定组别；或者操作两个单独的向量。</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="统计分析.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Welch t 检验</span></span>
<span id="cb195-2"><a href="统计分析.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(extra <span class="sc">~</span> group, sleep)</span>
<span id="cb195-3"><a href="统计分析.html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-4"><a href="统计分析.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb195-5"><a href="统计分析.html#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-6"><a href="统计分析.html#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  extra by group</span></span>
<span id="cb195-7"><a href="统计分析.html#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -1.9, df = 18, p-value = 0.08</span></span>
<span id="cb195-8"><a href="统计分析.html#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0</span></span>
<span id="cb195-9"><a href="统计分析.html#cb195-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb195-10"><a href="统计分析.html#cb195-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -3.3655  0.2055</span></span>
<span id="cb195-11"><a href="统计分析.html#cb195-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb195-12"><a href="统计分析.html#cb195-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean in group 1 mean in group 2 </span></span>
<span id="cb195-13"><a href="统计分析.html#cb195-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            0.75            2.33</span></span>
<span id="cb195-14"><a href="统计分析.html#cb195-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-15"><a href="统计分析.html#cb195-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 个独立的向量</span></span>
<span id="cb195-16"><a href="统计分析.html#cb195-16" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_wide<span class="sc">$</span>group1, sleep_wide<span class="sc">$</span>group2)</span>
<span id="cb195-17"><a href="统计分析.html#cb195-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-18"><a href="统计分析.html#cb195-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span id="cb195-19"><a href="统计分析.html#cb195-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb195-20"><a href="统计分析.html#cb195-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sleep_wide$group1 and sleep_wide$group2</span></span>
<span id="cb195-21"><a href="统计分析.html#cb195-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -1.9, df = 18, p-value = 0.08</span></span>
<span id="cb195-22"><a href="统计分析.html#cb195-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb195-23"><a href="统计分析.html#cb195-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb195-24"><a href="统计分析.html#cb195-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -3.3655  0.2055</span></span>
<span id="cb195-25"><a href="统计分析.html#cb195-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb195-26"><a href="统计分析.html#cb195-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x mean of y </span></span>
<span id="cb195-27"><a href="统计分析.html#cb195-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0.75      2.33</span></span></code></pre></div>
<p>默认，t 检验不假设有方差齐性（或称作方差同质）。默认的不是 Student t 检验而是使用了 Welch t 检验。注意 Welch t 检验结果中 <code>df=17.776</code>，这是因为对不同质方差进行了校正。要使用 Student t 检验的话，设置 <code>var.equal=TRUE</code> 。</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="统计分析.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Student t 检验</span></span>
<span id="cb196-2"><a href="统计分析.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(extra <span class="sc">~</span> group, sleep, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-3"><a href="统计分析.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-4"><a href="统计分析.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Two Sample t-test</span></span>
<span id="cb196-5"><a href="统计分析.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-6"><a href="统计分析.html#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  extra by group</span></span>
<span id="cb196-7"><a href="统计分析.html#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -1.9, df = 18, p-value = 0.08</span></span>
<span id="cb196-8"><a href="统计分析.html#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0</span></span>
<span id="cb196-9"><a href="统计分析.html#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb196-10"><a href="统计分析.html#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -3.3639  0.2039</span></span>
<span id="cb196-11"><a href="统计分析.html#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb196-12"><a href="统计分析.html#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean in group 1 mean in group 2 </span></span>
<span id="cb196-13"><a href="统计分析.html#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            0.75            2.33</span></span>
<span id="cb196-14"><a href="统计分析.html#cb196-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-15"><a href="统计分析.html#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 针对宽数据相同的操作 (2个分离的向量)</span></span>
<span id="cb196-16"><a href="统计分析.html#cb196-16" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_wide<span class="sc">$</span>group1, sleep_wide<span class="sc">$</span>group2, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb196-17"><a href="统计分析.html#cb196-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-18"><a href="统计分析.html#cb196-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Two Sample t-test</span></span>
<span id="cb196-19"><a href="统计分析.html#cb196-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb196-20"><a href="统计分析.html#cb196-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sleep_wide$group1 and sleep_wide$group2</span></span>
<span id="cb196-21"><a href="统计分析.html#cb196-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -1.9, df = 18, p-value = 0.08</span></span>
<span id="cb196-22"><a href="统计分析.html#cb196-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb196-23"><a href="统计分析.html#cb196-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb196-24"><a href="统计分析.html#cb196-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -3.3639  0.2039</span></span>
<span id="cb196-25"><a href="统计分析.html#cb196-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb196-26"><a href="统计分析.html#cb196-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x mean of y </span></span>
<span id="cb196-27"><a href="统计分析.html#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0.75      2.33</span></span></code></pre></div>
</div>
<div id="配对样本t检验" class="section level4" number="7.2.2.3">
<h4><span class="header-section-number">7.2.2.3</span> 配对样本t检验</h4>
<p>你也可以使用配对样本 t 检验比较配对的数据。数据配对是指你可能有对某种药物治疗前后有观测值或者不同治疗有配对的研究对象。</p>
<p>再次说明，<code>t-test()</code> 函数可以用于有分组变量的数据框或者两个向量。它依赖相对位置来决定配对。如果你使用有分组变量的长格式数据，group 1 的第一行与 group 2 的第一行配对。确保数据排序好并且不存在缺失值是非常重要的；否则配对可以丢弃。这种情况中，我们能通过 <code>group</code> 和 <code>ID</code> 变量进行排序来确保顺序是一样的。</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="统计分析.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按 group 和 ID排序</span></span>
<span id="cb197-2"><a href="统计分析.html#cb197-2" aria-hidden="true" tabindex="-1"></a>sleep <span class="ot">&lt;-</span> sleep[<span class="fu">order</span>(sleep<span class="sc">$</span>group, sleep<span class="sc">$</span>ID), ]</span>
<span id="cb197-3"><a href="统计分析.html#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="统计分析.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 配对 t-test</span></span>
<span id="cb197-5"><a href="统计分析.html#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(extra <span class="sc">~</span> group, sleep, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-6"><a href="统计分析.html#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb197-7"><a href="统计分析.html#cb197-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Paired t-test</span></span>
<span id="cb197-8"><a href="统计分析.html#cb197-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb197-9"><a href="统计分析.html#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  extra by group</span></span>
<span id="cb197-10"><a href="统计分析.html#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -4.1, df = 9, p-value = 0.003</span></span>
<span id="cb197-11"><a href="统计分析.html#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb197-12"><a href="统计分析.html#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb197-13"><a href="统计分析.html#cb197-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -2.4599 -0.7001</span></span>
<span id="cb197-14"><a href="统计分析.html#cb197-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb197-15"><a href="统计分析.html#cb197-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of the differences </span></span>
<span id="cb197-16"><a href="统计分析.html#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   -1.58</span></span>
<span id="cb197-17"><a href="统计分析.html#cb197-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-18"><a href="统计分析.html#cb197-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 针对宽数据相同的操作 (2个分离的向量)</span></span>
<span id="cb197-19"><a href="统计分析.html#cb197-19" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_wide<span class="sc">$</span>group1, sleep_wide<span class="sc">$</span>group2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-20"><a href="统计分析.html#cb197-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb197-21"><a href="统计分析.html#cb197-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Paired t-test</span></span>
<span id="cb197-22"><a href="统计分析.html#cb197-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb197-23"><a href="统计分析.html#cb197-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sleep_wide$group1 and sleep_wide$group2</span></span>
<span id="cb197-24"><a href="统计分析.html#cb197-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -4.1, df = 9, p-value = 0.003</span></span>
<span id="cb197-25"><a href="统计分析.html#cb197-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span id="cb197-26"><a href="统计分析.html#cb197-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb197-27"><a href="统计分析.html#cb197-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -2.4599 -0.7001</span></span>
<span id="cb197-28"><a href="统计分析.html#cb197-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb197-29"><a href="统计分析.html#cb197-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of the differences </span></span>
<span id="cb197-30"><a href="统计分析.html#cb197-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   -1.58</span></span></code></pre></div>
<p>配对 t 检验等价于检测是否配对的观察值的总体均值是否为 0 。</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="统计分析.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep_wide<span class="sc">$</span>group1 <span class="sc">-</span> sleep_wide<span class="sc">$</span>group2, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb198-2"><a href="统计分析.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb198-3"><a href="统计分析.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb198-4"><a href="统计分析.html#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb198-5"><a href="统计分析.html#cb198-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sleep_wide$group1 - sleep_wide$group2</span></span>
<span id="cb198-6"><a href="统计分析.html#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = -4.1, df = 9, p-value = 0.003</span></span>
<span id="cb198-7"><a href="统计分析.html#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span id="cb198-8"><a href="统计分析.html#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb198-9"><a href="统计分析.html#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -2.4599 -0.7001</span></span>
<span id="cb198-10"><a href="统计分析.html#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb198-11"><a href="统计分析.html#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb198-12"><a href="统计分析.html#cb198-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -1.58</span></span></code></pre></div>
</div>
<div id="与期望的总体均值进行比较单样本-t-检验" class="section level4" number="7.2.2.4">
<h4><span class="header-section-number">7.2.2.4</span> 与期望的总体均值进行比较：单样本 t 检验</h4>
<p>假设你想要检测是否 <code>extra</code> 列的数据抽取自总体均值为0的总体（这里忽略 <code>group</code> 与 <code>ID</code> 列）。</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="统计分析.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sleep<span class="sc">$</span>extra, <span class="at">mu =</span> <span class="dv">0</span>)</span>
<span id="cb199-2"><a href="统计分析.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-3"><a href="统计分析.html#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  One Sample t-test</span></span>
<span id="cb199-4"><a href="统计分析.html#cb199-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb199-5"><a href="统计分析.html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  sleep$extra</span></span>
<span id="cb199-6"><a href="统计分析.html#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t = 3.4, df = 19, p-value = 0.003</span></span>
<span id="cb199-7"><a href="统计分析.html#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span></span>
<span id="cb199-8"><a href="统计分析.html#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb199-9"><a href="统计分析.html#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.5956 2.4844</span></span>
<span id="cb199-10"><a href="统计分析.html#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb199-11"><a href="统计分析.html#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mean of x </span></span>
<span id="cb199-12"><a href="统计分析.html#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      1.54</span></span></code></pre></div>
</div>
</div>
</div>
<div id="频率检验" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> 频率检验</h2>
<div id="问题-45" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> 问题</h3>
<p>你有分类数据然后想要检验是否这些数据值的频数分布是否与预期不符，或者是否组间的频数分布有（显著）差异。</p>
</div>
<div id="方案-44" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> 方案</h3>
<p>频数检验通常解决两类问题：</p>
<ol style="list-style-type: decimal">
<li>频数分布与预期或者理论的分布（比如 50% 的 yes，50% 的 no ）符合吗？（拟合优度检验）</li>
<li>两组或多组之间的频率分布有差异吗？（独立检验）</li>
</ol>
<p>通常用于解决这样问题的统计检验方法，分为<strong>精确检验</strong>与<strong>近似检验</strong>两种。</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="center"><strong>期望分布</strong></th>
<th align="center"><strong>比较组别</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>精确</strong></td>
<td align="center">精确二项检验</td>
<td align="center">Fisher精确检验</td>
</tr>
<tr class="even">
<td><strong>近似</strong></td>
<td align="center">卡方拟合优度</td>
<td align="center">独立卡方检验</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>：精确二项检验仅能用于有两个水平的单变量。Fisher 精确检验仅能用于二维列联表（比如，当存在一个独立变量和一个非独立变量时它可以使用；但不能用于两个独立变量和一个非独立变量的情况）。</p>
<p>想要检验配对或被试内效应，我们可以使用 McNemar 检验。使用该检验必须满足存在两个水平的独立变量和两个水平的非独立变量。</p>
<p>想要检验有重复测量的两个变量独立性，我们可以使用 Cochran-Mantel-Haenszel 检验。</p>
<p>假设你有下面的数据，其中每一行代表一个记录：</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="统计分析.html#cb200-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb200-2"><a href="统计分析.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="st"> condition result</span></span>
<span id="cb200-3"><a href="统计分析.html#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-4"><a href="统计分析.html#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-5"><a href="统计分析.html#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-6"><a href="统计分析.html#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-7"><a href="统计分析.html#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-8"><a href="统计分析.html#cb200-8" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-9"><a href="统计分析.html#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-10"><a href="统计分析.html#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      0</span></span>
<span id="cb200-11"><a href="统计分析.html#cb200-11" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-12"><a href="统计分析.html#cb200-12" aria-hidden="true" tabindex="-1"></a><span class="st">   control      1</span></span>
<span id="cb200-13"><a href="统计分析.html#cb200-13" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-14"><a href="统计分析.html#cb200-14" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-15"><a href="统计分析.html#cb200-15" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-16"><a href="统计分析.html#cb200-16" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-17"><a href="统计分析.html#cb200-17" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      0</span></span>
<span id="cb200-18"><a href="统计分析.html#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-19"><a href="统计分析.html#cb200-19" aria-hidden="true" tabindex="-1"></a><span class="st">   control      1</span></span>
<span id="cb200-20"><a href="统计分析.html#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-21"><a href="统计分析.html#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="st">   control      1</span></span>
<span id="cb200-22"><a href="统计分析.html#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      0</span></span>
<span id="cb200-23"><a href="统计分析.html#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-24"><a href="统计分析.html#cb200-24" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      0</span></span>
<span id="cb200-25"><a href="统计分析.html#cb200-25" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      0</span></span>
<span id="cb200-26"><a href="统计分析.html#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-27"><a href="统计分析.html#cb200-27" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-28"><a href="统计分析.html#cb200-28" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-29"><a href="统计分析.html#cb200-29" aria-hidden="true" tabindex="-1"></a><span class="st">   control      0</span></span>
<span id="cb200-30"><a href="统计分析.html#cb200-30" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-31"><a href="统计分析.html#cb200-31" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      0</span></span>
<span id="cb200-32"><a href="统计分析.html#cb200-32" aria-hidden="true" tabindex="-1"></a><span class="st"> treatment      1</span></span>
<span id="cb200-33"><a href="统计分析.html#cb200-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<p>相比于以<strong>记录</strong>的数据框存储，你的数据可能是<strong>计数</strong>的数据框，或者是一个列联表。</p>
<div id="拟合优度检验-期望频率" class="section level4" number="7.3.2.1">
<h4><span class="header-section-number">7.3.2.1</span> 拟合优度检验 （期望频率）</h4>
<div id="卡方检验" class="section level5" number="7.3.2.1.1">
<h5><span class="header-section-number">7.3.2.1.1</span> 卡方检验</h5>
<p>想要检验假设：结果列 result（忽略条件 condition ）中的两个值在总体中几乎相等（50% - 50%）。</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="统计分析.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 为result列创建列联表，包含 0 和 1 两个值 　注意，&#39;0&#39;</span></span>
<span id="cb201-2"><a href="统计分析.html#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 和 &#39;1&#39; 是列名而不是实际的值</span></span>
<span id="cb201-3"><a href="统计分析.html#cb201-3" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>result)</span>
<span id="cb201-4"><a href="统计分析.html#cb201-4" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb201-5"><a href="统计分析.html#cb201-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-6"><a href="统计分析.html#cb201-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0  1 </span></span>
<span id="cb201-7"><a href="统计分析.html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 13</span></span>
<span id="cb201-8"><a href="统计分析.html#cb201-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-9"><a href="统计分析.html#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 也可以手动创建表格</span></span>
<span id="cb201-10"><a href="统计分析.html#cb201-10" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">13</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb201-11"><a href="统计分析.html#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ct) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb201-12"><a href="统计分析.html#cb201-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-13"><a href="统计分析.html#cb201-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行卡方检验</span></span>
<span id="cb201-14"><a href="统计分析.html#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ct)</span>
<span id="cb201-15"><a href="统计分析.html#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-16"><a href="统计分析.html#cb201-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chi-squared test for given probabilities</span></span>
<span id="cb201-17"><a href="统计分析.html#cb201-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb201-18"><a href="统计分析.html#cb201-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb201-19"><a href="统计分析.html#cb201-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 0.53, df = 1, p-value = 0.5</span></span></code></pre></div>
<p>想要检验有不同期望频率的样本（比如下面一个 0.75，一个 0.25 ）：</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="统计分析.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 概率表 —— 和必须为 1</span></span>
<span id="cb202-2"><a href="统计分析.html#cb202-2" aria-hidden="true" tabindex="-1"></a>pt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.25</span>)</span>
<span id="cb202-3"><a href="统计分析.html#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ct, <span class="at">p =</span> pt)</span>
<span id="cb202-4"><a href="统计分析.html#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb202-5"><a href="统计分析.html#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Chi-squared test for given probabilities</span></span>
<span id="cb202-6"><a href="统计分析.html#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb202-7"><a href="统计分析.html#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb202-8"><a href="统计分析.html#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 5.4, df = 1, p-value = 0.02</span></span></code></pre></div>
<p>如果你想要从检验结果中提取信息，可以将结果保存进一个变量，然后用 <code>str()</code> 函数查看变量信息，接着把你想要的部分取出来。例如：</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="统计分析.html#cb203-1" aria-hidden="true" tabindex="-1"></a>chi_res <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(ct, <span class="at">p =</span> pt)</span>
<span id="cb203-2"><a href="统计分析.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看所有组分</span></span>
<span id="cb203-3"><a href="统计分析.html#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(chi_res)</span>
<span id="cb203-4"><a href="统计分析.html#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 9</span></span>
<span id="cb203-5"><a href="统计分析.html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ statistic: Named num 5.38</span></span>
<span id="cb203-6"><a href="统计分析.html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;X-squared&quot;</span></span>
<span id="cb203-7"><a href="统计分析.html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ parameter: Named num 1</span></span>
<span id="cb203-8"><a href="统计分析.html#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;</span></span>
<span id="cb203-9"><a href="统计分析.html#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ p.value  : num 0.0204</span></span>
<span id="cb203-10"><a href="统计分析.html#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ method   : chr &quot;Chi-squared test for given probabilities&quot;</span></span>
<span id="cb203-11"><a href="统计分析.html#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ data.name: chr &quot;ct&quot;</span></span>
<span id="cb203-12"><a href="统计分析.html#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ observed : num [1:2] 17 13</span></span>
<span id="cb203-13"><a href="统计分析.html#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ expected : num [1:2] 22.5 7.5</span></span>
<span id="cb203-14"><a href="统计分析.html#cb203-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ residuals: num [1:2] -1.16 2.01</span></span>
<span id="cb203-15"><a href="统计分析.html#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ stdres   : num [1:2] -2.32 2.32</span></span>
<span id="cb203-16"><a href="统计分析.html#cb203-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</span></span>
<span id="cb203-17"><a href="统计分析.html#cb203-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-18"><a href="统计分析.html#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取卡方值</span></span>
<span id="cb203-19"><a href="统计分析.html#cb203-19" aria-hidden="true" tabindex="-1"></a>chi_res<span class="sc">$</span>statistic</span>
<span id="cb203-20"><a href="统计分析.html#cb203-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared </span></span>
<span id="cb203-21"><a href="统计分析.html#cb203-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     5.378</span></span>
<span id="cb203-22"><a href="统计分析.html#cb203-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-23"><a href="统计分析.html#cb203-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取p值</span></span>
<span id="cb203-24"><a href="统计分析.html#cb203-24" aria-hidden="true" tabindex="-1"></a>chi_res<span class="sc">$</span>p.value</span>
<span id="cb203-25"><a href="统计分析.html#cb203-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02039</span></span></code></pre></div>
</div>
<div id="精确二项检验" class="section level5" number="7.3.2.1.2">
<h5><span class="header-section-number">7.3.2.1.2</span> 精确二项检验</h5>
<p>精确二项检验仅能用于存在两个值的单变量数据。</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="统计分析.html#cb204-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>result)</span>
<span id="cb204-2"><a href="统计分析.html#cb204-2" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb204-3"><a href="统计分析.html#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-4"><a href="统计分析.html#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0  1 </span></span>
<span id="cb204-5"><a href="统计分析.html#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 17 13</span></span>
<span id="cb204-6"><a href="统计分析.html#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="统计分析.html#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(ct, <span class="at">p =</span> <span class="fl">0.5</span>)</span>
<span id="cb204-8"><a href="统计分析.html#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-9"><a href="统计分析.html#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Exact binomial test</span></span>
<span id="cb204-10"><a href="统计分析.html#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-11"><a href="统计分析.html#cb204-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb204-12"><a href="统计分析.html#cb204-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of successes = 17, number of trials = 30,</span></span>
<span id="cb204-13"><a href="统计分析.html#cb204-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value = 0.6</span></span>
<span id="cb204-14"><a href="统计分析.html#cb204-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true probability of success is not equal to 0.5</span></span>
<span id="cb204-15"><a href="统计分析.html#cb204-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb204-16"><a href="统计分析.html#cb204-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.3743 0.7454</span></span>
<span id="cb204-17"><a href="统计分析.html#cb204-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb204-18"><a href="统计分析.html#cb204-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; probability of success </span></span>
<span id="cb204-19"><a href="统计分析.html#cb204-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 0.5667</span></span>
<span id="cb204-20"><a href="统计分析.html#cb204-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-21"><a href="统计分析.html#cb204-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 75% 的期望概率——注意 1 在第二列，所以只需要令</span></span>
<span id="cb204-22"><a href="统计分析.html#cb204-22" aria-hidden="true" tabindex="-1"></a><span class="co"># p = 0.25</span></span>
<span id="cb204-23"><a href="统计分析.html#cb204-23" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(ct, <span class="at">p =</span> <span class="fl">0.25</span>)</span>
<span id="cb204-24"><a href="统计分析.html#cb204-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-25"><a href="统计分析.html#cb204-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Exact binomial test</span></span>
<span id="cb204-26"><a href="统计分析.html#cb204-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb204-27"><a href="统计分析.html#cb204-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb204-28"><a href="统计分析.html#cb204-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; number of successes = 17, number of trials = 30,</span></span>
<span id="cb204-29"><a href="统计分析.html#cb204-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value = 2e-04</span></span>
<span id="cb204-30"><a href="统计分析.html#cb204-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true probability of success is not equal to 0.25</span></span>
<span id="cb204-31"><a href="统计分析.html#cb204-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb204-32"><a href="统计分析.html#cb204-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.3743 0.7454</span></span>
<span id="cb204-33"><a href="统计分析.html#cb204-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb204-34"><a href="统计分析.html#cb204-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; probability of success </span></span>
<span id="cb204-35"><a href="统计分析.html#cb204-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 0.5667</span></span></code></pre></div>
<p>如果你想要从检验结果中提取信息，可以将结果保存进一个变量，然后用 <code>str()</code> 函数查看变量信息，接着把你想要的部分取出来。例如：</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="统计分析.html#cb205-1" aria-hidden="true" tabindex="-1"></a>bin_res <span class="ot">&lt;-</span> <span class="fu">binom.test</span>(ct, <span class="at">p =</span> <span class="fl">0.25</span>)</span>
<span id="cb205-2"><a href="统计分析.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 字符串格式化后查看信息</span></span>
<span id="cb205-3"><a href="统计分析.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bin_res)</span>
<span id="cb205-4"><a href="统计分析.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 9</span></span>
<span id="cb205-5"><a href="统计分析.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ statistic  : Named num 17</span></span>
<span id="cb205-6"><a href="统计分析.html#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;number of successes&quot;</span></span>
<span id="cb205-7"><a href="统计分析.html#cb205-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ parameter  : Named num 30</span></span>
<span id="cb205-8"><a href="统计分析.html#cb205-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;number of trials&quot;</span></span>
<span id="cb205-9"><a href="统计分析.html#cb205-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ p.value    : Named num 0.000216</span></span>
<span id="cb205-10"><a href="统计分析.html#cb205-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;0&quot;</span></span>
<span id="cb205-11"><a href="统计分析.html#cb205-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ conf.int   : num [1:2] 0.374 0.745</span></span>
<span id="cb205-12"><a href="统计分析.html#cb205-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;conf.level&quot;)= num 0.95</span></span>
<span id="cb205-13"><a href="统计分析.html#cb205-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ estimate   : Named num 0.567</span></span>
<span id="cb205-14"><a href="统计分析.html#cb205-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;probability of success&quot;</span></span>
<span id="cb205-15"><a href="统计分析.html#cb205-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ null.value : Named num 0.25</span></span>
<span id="cb205-16"><a href="统计分析.html#cb205-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;probability of success&quot;</span></span>
<span id="cb205-17"><a href="统计分析.html#cb205-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ alternative: chr &quot;two.sided&quot;</span></span>
<span id="cb205-18"><a href="统计分析.html#cb205-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ method     : chr &quot;Exact binomial test&quot;</span></span>
<span id="cb205-19"><a href="统计分析.html#cb205-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ data.name  : chr &quot;ct&quot;</span></span>
<span id="cb205-20"><a href="统计分析.html#cb205-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</span></span>
<span id="cb205-21"><a href="统计分析.html#cb205-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-22"><a href="统计分析.html#cb205-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取 p 值</span></span>
<span id="cb205-23"><a href="统计分析.html#cb205-23" aria-hidden="true" tabindex="-1"></a>bin_res<span class="sc">$</span>p.value</span>
<span id="cb205-24"><a href="统计分析.html#cb205-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         0 </span></span>
<span id="cb205-25"><a href="统计分析.html#cb205-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.0002157</span></span>
<span id="cb205-26"><a href="统计分析.html#cb205-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-27"><a href="统计分析.html#cb205-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取 95% 置信区间</span></span>
<span id="cb205-28"><a href="统计分析.html#cb205-28" aria-hidden="true" tabindex="-1"></a>bin_res<span class="sc">$</span>conf.int</span>
<span id="cb205-29"><a href="统计分析.html#cb205-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3743 0.7454</span></span>
<span id="cb205-30"><a href="统计分析.html#cb205-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;conf.level&quot;)</span></span>
<span id="cb205-31"><a href="统计分析.html#cb205-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.95</span></span></code></pre></div>
</div>
</div>
<div id="独立检验比较组间" class="section level4" number="7.3.2.2">
<h4><span class="header-section-number">7.3.2.2</span> 独立检验（比较组间）</h4>
<div id="卡方检验-1" class="section level5" number="7.3.2.2.1">
<h5><span class="header-section-number">7.3.2.2.1</span> 卡方检验</h5>
<p>想要检验控制和处理组结果的频数差异，使用二维列联表。</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="统计分析.html#cb206-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>condition, data<span class="sc">$</span>result)</span>
<span id="cb206-2"><a href="统计分析.html#cb206-2" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb206-3"><a href="统计分析.html#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            </span></span>
<span id="cb206-4"><a href="统计分析.html#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              0  1</span></span>
<span id="cb206-5"><a href="统计分析.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   control   11  3</span></span>
<span id="cb206-6"><a href="统计分析.html#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   treatment  6 10</span></span>
<span id="cb206-7"><a href="统计分析.html#cb206-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-8"><a href="统计分析.html#cb206-8" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ct)</span>
<span id="cb206-9"><a href="统计分析.html#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb206-10"><a href="统计分析.html#cb206-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Pearson&#39;s Chi-squared test with Yates&#39;</span></span>
<span id="cb206-11"><a href="统计分析.html#cb206-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  continuity correction</span></span>
<span id="cb206-12"><a href="统计分析.html#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb206-13"><a href="统计分析.html#cb206-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb206-14"><a href="统计分析.html#cb206-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 3.6, df = 1, p-value = 0.06</span></span>
<span id="cb206-15"><a href="统计分析.html#cb206-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-16"><a href="统计分析.html#cb206-16" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(ct, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb206-17"><a href="统计分析.html#cb206-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb206-18"><a href="统计分析.html#cb206-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Pearson&#39;s Chi-squared test</span></span>
<span id="cb206-19"><a href="统计分析.html#cb206-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb206-20"><a href="统计分析.html#cb206-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb206-21"><a href="统计分析.html#cb206-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X-squared = 5.1, df = 1, p-value = 0.02</span></span></code></pre></div>
</div>
<div id="fisher-精确检验" class="section level5" number="7.3.2.2.2">
<h5><span class="header-section-number">7.3.2.2.2</span> Fisher 精确检验</h5>
<p>对于小样本而言 Fisher 精确检验更为适合。小样本的 2x2 列表非常典型，样本更多、更复杂的列表计算强度非常大。当然，用R进行比较复杂的计算也是没有太大问题的。</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="统计分析.html#cb207-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>condition, data<span class="sc">$</span>result)</span>
<span id="cb207-2"><a href="统计分析.html#cb207-2" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb207-3"><a href="统计分析.html#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            </span></span>
<span id="cb207-4"><a href="统计分析.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              0  1</span></span>
<span id="cb207-5"><a href="统计分析.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   control   11  3</span></span>
<span id="cb207-6"><a href="统计分析.html#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   treatment  6 10</span></span>
<span id="cb207-7"><a href="统计分析.html#cb207-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-8"><a href="统计分析.html#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(ct)</span>
<span id="cb207-9"><a href="统计分析.html#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb207-10"><a href="统计分析.html#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Fisher&#39;s Exact Test for Count Data</span></span>
<span id="cb207-11"><a href="统计分析.html#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb207-12"><a href="统计分析.html#cb207-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb207-13"><a href="统计分析.html#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value = 0.03</span></span>
<span id="cb207-14"><a href="统计分析.html#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span id="cb207-15"><a href="统计分析.html#cb207-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb207-16"><a href="统计分析.html#cb207-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0.9669 45.5550</span></span>
<span id="cb207-17"><a href="统计分析.html#cb207-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb207-18"><a href="统计分析.html#cb207-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; odds ratio </span></span>
<span id="cb207-19"><a href="统计分析.html#cb207-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      5.714</span></span></code></pre></div>
</div>
<div id="cochran-mantel-haenszel-检验" class="section level5" number="7.3.2.2.3">
<h5><span class="header-section-number">7.3.2.2.3</span> Cochran-Mantel-Haenszel 检验</h5>
<p>Cochran-Mantel-Haenszel 检验 （或称为 Mantel-Haenszel 检验)）用于检验重复测量两离散变量的独立性。通常使用 2x2xK 列表表示，K是测量条件的次数。比如你想要指导是否一个处理（C vs. D）是否影响了恢复的概率（yes or no）。假设该处理一天监控测量三次——早上、中午和晚上，而你想要你的检验能够控制它。那么你可以使用 CMH 检验对 2x2x3 列联表进行操作，第三个变量是你想要控制的变量。</p>
<p>R 中的 CMH 检验可以处理比 2x2xK 维度更高的数据，例如你处理 3x3xK 列联表。</p>
<p>在接下来的例子里有三个变量：Location、Allele 和 Habitat。问题是——当控制 location 变量时，Allel（94 或非 94）和 Habitat（marine 或 estuarine）两个变量是否独立。</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="统计分析.html#cb208-1" aria-hidden="true" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb208-2"><a href="统计分析.html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="st">  Location Allele   Habitat Count</span></span>
<span id="cb208-3"><a href="统计分析.html#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="st"> tillamook     94    marine    56</span></span>
<span id="cb208-4"><a href="统计分析.html#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="st"> tillamook     94 estuarine    69</span></span>
<span id="cb208-5"><a href="统计分析.html#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="st"> tillamook non-94    marine    40</span></span>
<span id="cb208-6"><a href="统计分析.html#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="st"> tillamook non-94 estuarine    77</span></span>
<span id="cb208-7"><a href="统计分析.html#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="st">   yaquina     94    marine    61</span></span>
<span id="cb208-8"><a href="统计分析.html#cb208-8" aria-hidden="true" tabindex="-1"></a><span class="st">   yaquina     94 estuarine   257</span></span>
<span id="cb208-9"><a href="统计分析.html#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="st">   yaquina non-94    marine    57</span></span>
<span id="cb208-10"><a href="统计分析.html#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="st">   yaquina non-94 estuarine   301</span></span>
<span id="cb208-11"><a href="统计分析.html#cb208-11" aria-hidden="true" tabindex="-1"></a><span class="st">     alsea     94    marine    73</span></span>
<span id="cb208-12"><a href="统计分析.html#cb208-12" aria-hidden="true" tabindex="-1"></a><span class="st">     alsea     94 estuarine    65</span></span>
<span id="cb208-13"><a href="统计分析.html#cb208-13" aria-hidden="true" tabindex="-1"></a><span class="st">     alsea non-94    marine    71</span></span>
<span id="cb208-14"><a href="统计分析.html#cb208-14" aria-hidden="true" tabindex="-1"></a><span class="st">     alsea non-94 estuarine    79</span></span>
<span id="cb208-15"><a href="统计分析.html#cb208-15" aria-hidden="true" tabindex="-1"></a><span class="st">    umpqua     94    marine    71</span></span>
<span id="cb208-16"><a href="统计分析.html#cb208-16" aria-hidden="true" tabindex="-1"></a><span class="st">    umpqua     94 estuarine    48</span></span>
<span id="cb208-17"><a href="统计分析.html#cb208-17" aria-hidden="true" tabindex="-1"></a><span class="st">    umpqua non-94    marine    55</span></span>
<span id="cb208-18"><a href="统计分析.html#cb208-18" aria-hidden="true" tabindex="-1"></a><span class="st">    umpqua non-94 estuarine    48</span></span>
<span id="cb208-19"><a href="统计分析.html#cb208-19" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<p>注意上面的数据是<strong>计数</strong>的数据框，而不是像之前的例子是<strong>记录</strong>的数据框。这里我们使用 <code>xtabs()</code> 函数将它转换为列联表。</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="统计分析.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 制造一个三维的列联表，最后一个变量时要控制的</span></span>
<span id="cb209-2"><a href="统计分析.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Location 变量</span></span>
<span id="cb209-3"><a href="统计分析.html#cb209-3" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Allele <span class="sc">+</span> Habitat <span class="sc">+</span> Location, <span class="at">data =</span> fish)</span>
<span id="cb209-4"><a href="统计分析.html#cb209-4" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb209-5"><a href="统计分析.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; , , Location = alsea</span></span>
<span id="cb209-6"><a href="统计分析.html#cb209-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-7"><a href="统计分析.html#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Habitat</span></span>
<span id="cb209-8"><a href="统计分析.html#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Allele   estuarine marine</span></span>
<span id="cb209-9"><a href="统计分析.html#cb209-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   94            65     73</span></span>
<span id="cb209-10"><a href="统计分析.html#cb209-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   non-94        79     71</span></span>
<span id="cb209-11"><a href="统计分析.html#cb209-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-12"><a href="统计分析.html#cb209-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; , , Location = tillamook</span></span>
<span id="cb209-13"><a href="统计分析.html#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-14"><a href="统计分析.html#cb209-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Habitat</span></span>
<span id="cb209-15"><a href="统计分析.html#cb209-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Allele   estuarine marine</span></span>
<span id="cb209-16"><a href="统计分析.html#cb209-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   94            69     56</span></span>
<span id="cb209-17"><a href="统计分析.html#cb209-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   non-94        77     40</span></span>
<span id="cb209-18"><a href="统计分析.html#cb209-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-19"><a href="统计分析.html#cb209-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; , , Location = umpqua</span></span>
<span id="cb209-20"><a href="统计分析.html#cb209-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-21"><a href="统计分析.html#cb209-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Habitat</span></span>
<span id="cb209-22"><a href="统计分析.html#cb209-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Allele   estuarine marine</span></span>
<span id="cb209-23"><a href="统计分析.html#cb209-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   94            48     71</span></span>
<span id="cb209-24"><a href="统计分析.html#cb209-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   non-94        48     55</span></span>
<span id="cb209-25"><a href="统计分析.html#cb209-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-26"><a href="统计分析.html#cb209-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; , , Location = yaquina</span></span>
<span id="cb209-27"><a href="统计分析.html#cb209-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-28"><a href="统计分析.html#cb209-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Habitat</span></span>
<span id="cb209-29"><a href="统计分析.html#cb209-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Allele   estuarine marine</span></span>
<span id="cb209-30"><a href="统计分析.html#cb209-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   94           257     61</span></span>
<span id="cb209-31"><a href="统计分析.html#cb209-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   non-94       301     57</span></span>
<span id="cb209-32"><a href="统计分析.html#cb209-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-33"><a href="统计分析.html#cb209-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 以扁平化显示</span></span>
<span id="cb209-34"><a href="统计分析.html#cb209-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(ct)</span>
<span id="cb209-35"><a href="统计分析.html#cb209-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Location alsea tillamook umpqua yaquina</span></span>
<span id="cb209-36"><a href="统计分析.html#cb209-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Allele Habitat                                          </span></span>
<span id="cb209-37"><a href="统计分析.html#cb209-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 94     estuarine             65        69     48     257</span></span>
<span id="cb209-38"><a href="统计分析.html#cb209-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        marine                73        56     71      61</span></span>
<span id="cb209-39"><a href="统计分析.html#cb209-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; non-94 estuarine             79        77     48     301</span></span>
<span id="cb209-40"><a href="统计分析.html#cb209-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        marine                71        40     55      57</span></span>
<span id="cb209-41"><a href="统计分析.html#cb209-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-42"><a href="统计分析.html#cb209-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 按指定方式进行变量输出</span></span>
<span id="cb209-43"><a href="统计分析.html#cb209-43" aria-hidden="true" tabindex="-1"></a><span class="fu">ftable</span>(ct, <span class="at">row.vars =</span> <span class="fu">c</span>(<span class="st">&quot;Location&quot;</span>, <span class="st">&quot;Allele&quot;</span>), <span class="at">col.vars =</span> <span class="st">&quot;Habitat&quot;</span>)</span>
<span id="cb209-44"><a href="统计分析.html#cb209-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  Habitat estuarine marine</span></span>
<span id="cb209-45"><a href="统计分析.html#cb209-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Location  Allele                         </span></span>
<span id="cb209-46"><a href="统计分析.html#cb209-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alsea     94                    65     73</span></span>
<span id="cb209-47"><a href="统计分析.html#cb209-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           non-94                79     71</span></span>
<span id="cb209-48"><a href="统计分析.html#cb209-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; tillamook 94                    69     56</span></span>
<span id="cb209-49"><a href="统计分析.html#cb209-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           non-94                77     40</span></span>
<span id="cb209-50"><a href="统计分析.html#cb209-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; umpqua    94                    48     71</span></span>
<span id="cb209-51"><a href="统计分析.html#cb209-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           non-94                48     55</span></span>
<span id="cb209-52"><a href="统计分析.html#cb209-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; yaquina   94                   257     61</span></span>
<span id="cb209-53"><a href="统计分析.html#cb209-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           non-94               301     57</span></span>
<span id="cb209-54"><a href="统计分析.html#cb209-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-55"><a href="统计分析.html#cb209-55" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct)</span>
<span id="cb209-56"><a href="统计分析.html#cb209-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-57"><a href="统计分析.html#cb209-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mantel-Haenszel chi-squared test with</span></span>
<span id="cb209-58"><a href="统计分析.html#cb209-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  continuity correction</span></span>
<span id="cb209-59"><a href="统计分析.html#cb209-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb209-60"><a href="统计分析.html#cb209-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb209-61"><a href="统计分析.html#cb209-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel-Haenszel X-squared = 5, df = 1, p-value =</span></span>
<span id="cb209-62"><a href="统计分析.html#cb209-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.02</span></span>
<span id="cb209-63"><a href="统计分析.html#cb209-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true common odds ratio is not equal to 1</span></span>
<span id="cb209-64"><a href="统计分析.html#cb209-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb209-65"><a href="统计分析.html#cb209-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.6006 0.9593</span></span>
<span id="cb209-66"><a href="统计分析.html#cb209-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb209-67"><a href="统计分析.html#cb209-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; common odds ratio </span></span>
<span id="cb209-68"><a href="统计分析.html#cb209-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             0.759</span></span></code></pre></div>
<p>根据检验结果，当控制 Location 变量时 Allele 与 Habitat 变量存在相关（p = 0.025）。</p>
<p>注意列联表的前两个维度处理是一致的，所以前后顺序变化都不会影响结果。而最后一个变量变化会导致结果的不同，下面是一个实例。</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="统计分析.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 下面两个看似不同的列联表，实际检验结果相同</span></span>
<span id="cb210-2"><a href="统计分析.html#cb210-2" aria-hidden="true" tabindex="-1"></a>ct<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Habitat <span class="sc">+</span> Allele <span class="sc">+</span> Location, <span class="at">data =</span> fish)</span>
<span id="cb210-3"><a href="统计分析.html#cb210-3" aria-hidden="true" tabindex="-1"></a>ct<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Allele <span class="sc">+</span> Habitat <span class="sc">+</span> Location, <span class="at">data =</span> fish)</span>
<span id="cb210-4"><a href="统计分析.html#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct<span class="fl">.1</span>)</span>
<span id="cb210-5"><a href="统计分析.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-6"><a href="统计分析.html#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mantel-Haenszel chi-squared test with</span></span>
<span id="cb210-7"><a href="统计分析.html#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  continuity correction</span></span>
<span id="cb210-8"><a href="统计分析.html#cb210-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-9"><a href="统计分析.html#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct.1</span></span>
<span id="cb210-10"><a href="统计分析.html#cb210-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel-Haenszel X-squared = 5, df = 1, p-value =</span></span>
<span id="cb210-11"><a href="统计分析.html#cb210-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.02</span></span>
<span id="cb210-12"><a href="统计分析.html#cb210-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true common odds ratio is not equal to 1</span></span>
<span id="cb210-13"><a href="统计分析.html#cb210-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb210-14"><a href="统计分析.html#cb210-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.6006 0.9593</span></span>
<span id="cb210-15"><a href="统计分析.html#cb210-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb210-16"><a href="统计分析.html#cb210-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; common odds ratio </span></span>
<span id="cb210-17"><a href="统计分析.html#cb210-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             0.759</span></span>
<span id="cb210-18"><a href="统计分析.html#cb210-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-19"><a href="统计分析.html#cb210-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct<span class="fl">.2</span>)</span>
<span id="cb210-20"><a href="统计分析.html#cb210-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-21"><a href="统计分析.html#cb210-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mantel-Haenszel chi-squared test with</span></span>
<span id="cb210-22"><a href="统计分析.html#cb210-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  continuity correction</span></span>
<span id="cb210-23"><a href="统计分析.html#cb210-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-24"><a href="统计分析.html#cb210-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct.2</span></span>
<span id="cb210-25"><a href="统计分析.html#cb210-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mantel-Haenszel X-squared = 5, df = 1, p-value =</span></span>
<span id="cb210-26"><a href="统计分析.html#cb210-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.02</span></span>
<span id="cb210-27"><a href="统计分析.html#cb210-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true common odds ratio is not equal to 1</span></span>
<span id="cb210-28"><a href="统计分析.html#cb210-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb210-29"><a href="统计分析.html#cb210-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.6006 0.9593</span></span>
<span id="cb210-30"><a href="统计分析.html#cb210-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb210-31"><a href="统计分析.html#cb210-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; common odds ratio </span></span>
<span id="cb210-32"><a href="统计分析.html#cb210-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             0.759</span></span>
<span id="cb210-33"><a href="统计分析.html#cb210-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-34"><a href="统计分析.html#cb210-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 把 Allele 放到最后，结果不同了</span></span>
<span id="cb210-35"><a href="统计分析.html#cb210-35" aria-hidden="true" tabindex="-1"></a>ct<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Location <span class="sc">+</span> Habitat <span class="sc">+</span> Allele, <span class="at">data =</span> fish)</span>
<span id="cb210-36"><a href="统计分析.html#cb210-36" aria-hidden="true" tabindex="-1"></a>ct<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Habitat <span class="sc">+</span> Location <span class="sc">+</span> Allele, <span class="at">data =</span> fish)</span>
<span id="cb210-37"><a href="统计分析.html#cb210-37" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct<span class="fl">.3</span>)</span>
<span id="cb210-38"><a href="统计分析.html#cb210-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-39"><a href="统计分析.html#cb210-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Cochran-Mantel-Haenszel test</span></span>
<span id="cb210-40"><a href="统计分析.html#cb210-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-41"><a href="统计分析.html#cb210-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct.3</span></span>
<span id="cb210-42"><a href="统计分析.html#cb210-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 168, df = 3,</span></span>
<span id="cb210-43"><a href="统计分析.html#cb210-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value &lt;2e-16</span></span>
<span id="cb210-44"><a href="统计分析.html#cb210-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-45"><a href="统计分析.html#cb210-45" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct<span class="fl">.4</span>)</span>
<span id="cb210-46"><a href="统计分析.html#cb210-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-47"><a href="统计分析.html#cb210-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Cochran-Mantel-Haenszel test</span></span>
<span id="cb210-48"><a href="统计分析.html#cb210-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-49"><a href="统计分析.html#cb210-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct.4</span></span>
<span id="cb210-50"><a href="统计分析.html#cb210-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 168, df = 3,</span></span>
<span id="cb210-51"><a href="统计分析.html#cb210-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value &lt;2e-16</span></span>
<span id="cb210-52"><a href="统计分析.html#cb210-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-53"><a href="统计分析.html#cb210-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 把 Habitat 放最后，结果也不同</span></span>
<span id="cb210-54"><a href="统计分析.html#cb210-54" aria-hidden="true" tabindex="-1"></a>ct<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Allele <span class="sc">+</span> Location <span class="sc">+</span> Habitat, <span class="at">data =</span> fish)</span>
<span id="cb210-55"><a href="统计分析.html#cb210-55" aria-hidden="true" tabindex="-1"></a>ct<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Count <span class="sc">~</span> Location <span class="sc">+</span> Allele <span class="sc">+</span> Habitat, <span class="at">data =</span> fish)</span>
<span id="cb210-56"><a href="统计分析.html#cb210-56" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct<span class="fl">.5</span>)</span>
<span id="cb210-57"><a href="统计分析.html#cb210-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-58"><a href="统计分析.html#cb210-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Cochran-Mantel-Haenszel test</span></span>
<span id="cb210-59"><a href="统计分析.html#cb210-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-60"><a href="统计分析.html#cb210-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct.5</span></span>
<span id="cb210-61"><a href="统计分析.html#cb210-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 2, df = 3, p-value</span></span>
<span id="cb210-62"><a href="统计分析.html#cb210-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = 0.6</span></span>
<span id="cb210-63"><a href="统计分析.html#cb210-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-64"><a href="统计分析.html#cb210-64" aria-hidden="true" tabindex="-1"></a><span class="fu">mantelhaen.test</span>(ct<span class="fl">.6</span>)</span>
<span id="cb210-65"><a href="统计分析.html#cb210-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-66"><a href="统计分析.html#cb210-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Cochran-Mantel-Haenszel test</span></span>
<span id="cb210-67"><a href="统计分析.html#cb210-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb210-68"><a href="统计分析.html#cb210-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct.6</span></span>
<span id="cb210-69"><a href="统计分析.html#cb210-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 2, df = 3, p-value</span></span>
<span id="cb210-70"><a href="统计分析.html#cb210-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = 0.6</span></span></code></pre></div>
</div>
</div>
<div id="mcnemar-检验" class="section level4" number="7.3.2.3">
<h4><span class="header-section-number">7.3.2.3</span> McNemar 检验</h4>
<p>McNemar 检验概念上是频数数据的一个被试内检验。例如，假设你想要检验是否一个处理增加了一个人对某个问题反应「yes」的概率，而且你只有每个人处理前和处理后的数据。标准的卡方检验将不合适，因为它假设了组别是独立的。取而代之，我们可以使用 McNemar 检验。该检验仅适用于当存在一个独立变量的两次测量时。用于 McNemar 的列联表与用于卡方检验的非常相似，但结构上是不同的。</p>
<p>假设你有下面的数据。每个对象有处理前和后的反应。</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="统计分析.html#cb211-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb211-2"><a href="统计分析.html#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="st"> subject time result</span></span>
<span id="cb211-3"><a href="统计分析.html#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="st">       1  pre      0</span></span>
<span id="cb211-4"><a href="统计分析.html#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="st">       1 post      1</span></span>
<span id="cb211-5"><a href="统计分析.html#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="st">       2  pre      1</span></span>
<span id="cb211-6"><a href="统计分析.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="st">       2 post      1</span></span>
<span id="cb211-7"><a href="统计分析.html#cb211-7" aria-hidden="true" tabindex="-1"></a><span class="st">       3  pre      0</span></span>
<span id="cb211-8"><a href="统计分析.html#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="st">       3 post      1</span></span>
<span id="cb211-9"><a href="统计分析.html#cb211-9" aria-hidden="true" tabindex="-1"></a><span class="st">       4  pre      1</span></span>
<span id="cb211-10"><a href="统计分析.html#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="st">       4 post      0</span></span>
<span id="cb211-11"><a href="统计分析.html#cb211-11" aria-hidden="true" tabindex="-1"></a><span class="st">       5  pre      1</span></span>
<span id="cb211-12"><a href="统计分析.html#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="st">       5 post      1</span></span>
<span id="cb211-13"><a href="统计分析.html#cb211-13" aria-hidden="true" tabindex="-1"></a><span class="st">       6  pre      0</span></span>
<span id="cb211-14"><a href="统计分析.html#cb211-14" aria-hidden="true" tabindex="-1"></a><span class="st">       6 post      1</span></span>
<span id="cb211-15"><a href="统计分析.html#cb211-15" aria-hidden="true" tabindex="-1"></a><span class="st">       7  pre      0</span></span>
<span id="cb211-16"><a href="统计分析.html#cb211-16" aria-hidden="true" tabindex="-1"></a><span class="st">       7 post      1</span></span>
<span id="cb211-17"><a href="统计分析.html#cb211-17" aria-hidden="true" tabindex="-1"></a><span class="st">       8  pre      0</span></span>
<span id="cb211-18"><a href="统计分析.html#cb211-18" aria-hidden="true" tabindex="-1"></a><span class="st">       8 post      1</span></span>
<span id="cb211-19"><a href="统计分析.html#cb211-19" aria-hidden="true" tabindex="-1"></a><span class="st">       9  pre      0</span></span>
<span id="cb211-20"><a href="统计分析.html#cb211-20" aria-hidden="true" tabindex="-1"></a><span class="st">       9 post      1</span></span>
<span id="cb211-21"><a href="统计分析.html#cb211-21" aria-hidden="true" tabindex="-1"></a><span class="st">      10  pre      1</span></span>
<span id="cb211-22"><a href="统计分析.html#cb211-22" aria-hidden="true" tabindex="-1"></a><span class="st">      10 post      1</span></span>
<span id="cb211-23"><a href="统计分析.html#cb211-23" aria-hidden="true" tabindex="-1"></a><span class="st">      11  pre      0</span></span>
<span id="cb211-24"><a href="统计分析.html#cb211-24" aria-hidden="true" tabindex="-1"></a><span class="st">      11 post      0</span></span>
<span id="cb211-25"><a href="统计分析.html#cb211-25" aria-hidden="true" tabindex="-1"></a><span class="st">      12  pre      1</span></span>
<span id="cb211-26"><a href="统计分析.html#cb211-26" aria-hidden="true" tabindex="-1"></a><span class="st">      12 post      1</span></span>
<span id="cb211-27"><a href="统计分析.html#cb211-27" aria-hidden="true" tabindex="-1"></a><span class="st">      13  pre      0</span></span>
<span id="cb211-28"><a href="统计分析.html#cb211-28" aria-hidden="true" tabindex="-1"></a><span class="st">      13 post      1</span></span>
<span id="cb211-29"><a href="统计分析.html#cb211-29" aria-hidden="true" tabindex="-1"></a><span class="st">      14  pre      0</span></span>
<span id="cb211-30"><a href="统计分析.html#cb211-30" aria-hidden="true" tabindex="-1"></a><span class="st">      14 post      0</span></span>
<span id="cb211-31"><a href="统计分析.html#cb211-31" aria-hidden="true" tabindex="-1"></a><span class="st">      15  pre      0</span></span>
<span id="cb211-32"><a href="统计分析.html#cb211-32" aria-hidden="true" tabindex="-1"></a><span class="st">      15 post      1</span></span>
<span id="cb211-33"><a href="统计分析.html#cb211-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="统计分析.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb212-2"><a href="统计分析.html#cb212-2" aria-hidden="true" tabindex="-1"></a>data_wide <span class="ot">&lt;-</span> <span class="fu">spread</span>(data, time, result)</span>
<span id="cb212-3"><a href="统计分析.html#cb212-3" aria-hidden="true" tabindex="-1"></a>data_wide</span>
<span id="cb212-4"><a href="统计分析.html#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    subject post pre</span></span>
<span id="cb212-5"><a href="统计分析.html#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1        1    1   0</span></span>
<span id="cb212-6"><a href="统计分析.html#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2        2    1   1</span></span>
<span id="cb212-7"><a href="统计分析.html#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3        3    1   0</span></span>
<span id="cb212-8"><a href="统计分析.html#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4        4    0   1</span></span>
<span id="cb212-9"><a href="统计分析.html#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5        5    1   1</span></span>
<span id="cb212-10"><a href="统计分析.html#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6        6    1   0</span></span>
<span id="cb212-11"><a href="统计分析.html#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7        7    1   0</span></span>
<span id="cb212-12"><a href="统计分析.html#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8        8    1   0</span></span>
<span id="cb212-13"><a href="统计分析.html#cb212-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9        9    1   0</span></span>
<span id="cb212-14"><a href="统计分析.html#cb212-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10      10    1   1</span></span>
<span id="cb212-15"><a href="统计分析.html#cb212-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 11      11    0   0</span></span>
<span id="cb212-16"><a href="统计分析.html#cb212-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 12      12    1   1</span></span>
<span id="cb212-17"><a href="统计分析.html#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13      13    1   0</span></span>
<span id="cb212-18"><a href="统计分析.html#cb212-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 14      14    0   0</span></span>
<span id="cb212-19"><a href="统计分析.html#cb212-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15      15    1   0</span></span></code></pre></div>
<p>接下来从数据框的 <code>pre</code> 和 <code>post</code> 列生成列联表：</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="统计分析.html#cb213-1" aria-hidden="true" tabindex="-1"></a>ct <span class="ot">&lt;-</span> <span class="fu">table</span>(data_wide[, <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>, <span class="st">&quot;post&quot;</span>)])</span>
<span id="cb213-2"><a href="统计分析.html#cb213-2" aria-hidden="true" tabindex="-1"></a>ct</span>
<span id="cb213-3"><a href="统计分析.html#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    post</span></span>
<span id="cb213-4"><a href="统计分析.html#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pre 0 1</span></span>
<span id="cb213-5"><a href="统计分析.html#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   0 2 8</span></span>
<span id="cb213-6"><a href="统计分析.html#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1 1 4</span></span>
<span id="cb213-7"><a href="统计分析.html#cb213-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-8"><a href="统计分析.html#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 下面是用于标准卡方检验的列联表，注意差别</span></span>
<span id="cb213-9"><a href="统计分析.html#cb213-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data[, <span class="fu">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;result&quot;</span>)])</span>
<span id="cb213-10"><a href="统计分析.html#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       result</span></span>
<span id="cb213-11"><a href="统计分析.html#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time    0  1</span></span>
<span id="cb213-12"><a href="统计分析.html#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   post  3 12</span></span>
<span id="cb213-13"><a href="统计分析.html#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   pre  10  5</span></span></code></pre></div>
<p>执行检验：</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="统计分析.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcnemar.test</span>(ct)</span>
<span id="cb214-2"><a href="统计分析.html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb214-3"><a href="统计分析.html#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  McNemar&#39;s Chi-squared test with continuity</span></span>
<span id="cb214-4"><a href="统计分析.html#cb214-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  correction</span></span>
<span id="cb214-5"><a href="统计分析.html#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb214-6"><a href="统计分析.html#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb214-7"><a href="统计分析.html#cb214-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; McNemar&#39;s chi-squared = 4, df = 1, p-value =</span></span>
<span id="cb214-8"><a href="统计分析.html#cb214-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.05</span></span></code></pre></div>
<p>对于小样本，它会使用连续校正。我们可以使用<strong>精确</strong>校正的 McNemar 检验替换这种校正方式，前者更加的精确，可通过 <code>exact2x2</code> 包获取。</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="统计分析.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(exact2x2)</span>
<span id="cb215-2"><a href="统计分析.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入需要的程辑包：exactci</span></span>
<span id="cb215-3"><a href="统计分析.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入需要的程辑包：ssanv</span></span>
<span id="cb215-4"><a href="统计分析.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入需要的程辑包：testthat</span></span>
<span id="cb215-5"><a href="统计分析.html#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb215-6"><a href="统计分析.html#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入程辑包：&#39;testthat&#39;</span></span>
<span id="cb215-7"><a href="统计分析.html#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:tidyr&#39;:</span></span>
<span id="cb215-8"><a href="统计分析.html#cb215-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb215-9"><a href="统计分析.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     matches</span></span>
<span id="cb215-10"><a href="统计分析.html#cb215-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-11"><a href="统计分析.html#cb215-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mcnemar.exact</span>(ct)</span>
<span id="cb215-12"><a href="统计分析.html#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb215-13"><a href="统计分析.html#cb215-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Exact McNemar test (with central confidence</span></span>
<span id="cb215-14"><a href="统计分析.html#cb215-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  intervals)</span></span>
<span id="cb215-15"><a href="统计分析.html#cb215-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb215-16"><a href="统计分析.html#cb215-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  ct</span></span>
<span id="cb215-17"><a href="统计分析.html#cb215-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b = 8, c = 1, p-value = 0.04</span></span>
<span id="cb215-18"><a href="统计分析.html#cb215-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span id="cb215-19"><a href="统计分析.html#cb215-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span id="cb215-20"><a href="统计分析.html#cb215-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1.073 354.981</span></span>
<span id="cb215-21"><a href="统计分析.html#cb215-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sample estimates:</span></span>
<span id="cb215-22"><a href="统计分析.html#cb215-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; odds ratio </span></span>
<span id="cb215-23"><a href="统计分析.html#cb215-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          8</span></span></code></pre></div>
</div>
</div>
</div>
<div id="anova" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> ANOVA</h2>
<div id="问题-46" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> 问题</h3>
<p>你想要使用 ANOVA 比较多组之间的差异。</p>
</div>
<div id="方案-45" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> 方案</h3>
<p>假设这是你的数据：</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="统计分析.html#cb216-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">text =</span> <span class="st">&quot;</span></span>
<span id="cb216-2"><a href="统计分析.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="st"> subject sex   age before after</span></span>
<span id="cb216-3"><a href="统计分析.html#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="st">       1   F   old    9.5   7.1</span></span>
<span id="cb216-4"><a href="统计分析.html#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="st">       2   M   old   10.3  11.0</span></span>
<span id="cb216-5"><a href="统计分析.html#cb216-5" aria-hidden="true" tabindex="-1"></a><span class="st">       3   M   old    7.5   5.8</span></span>
<span id="cb216-6"><a href="统计分析.html#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="st">       4   F   old   12.4   8.8</span></span>
<span id="cb216-7"><a href="统计分析.html#cb216-7" aria-hidden="true" tabindex="-1"></a><span class="st">       5   M   old   10.2   8.6</span></span>
<span id="cb216-8"><a href="统计分析.html#cb216-8" aria-hidden="true" tabindex="-1"></a><span class="st">       6   M   old   11.0   8.0</span></span>
<span id="cb216-9"><a href="统计分析.html#cb216-9" aria-hidden="true" tabindex="-1"></a><span class="st">       7   M young    9.1   3.0</span></span>
<span id="cb216-10"><a href="统计分析.html#cb216-10" aria-hidden="true" tabindex="-1"></a><span class="st">       8   F young    7.9   5.2</span></span>
<span id="cb216-11"><a href="统计分析.html#cb216-11" aria-hidden="true" tabindex="-1"></a><span class="st">       9   F   old    6.6   3.4</span></span>
<span id="cb216-12"><a href="统计分析.html#cb216-12" aria-hidden="true" tabindex="-1"></a><span class="st">      10   M young    7.7   4.0</span></span>
<span id="cb216-13"><a href="统计分析.html#cb216-13" aria-hidden="true" tabindex="-1"></a><span class="st">      11   M young    9.4   5.3</span></span>
<span id="cb216-14"><a href="统计分析.html#cb216-14" aria-hidden="true" tabindex="-1"></a><span class="st">      12   M   old   11.6  11.3</span></span>
<span id="cb216-15"><a href="统计分析.html#cb216-15" aria-hidden="true" tabindex="-1"></a><span class="st">      13   M young    9.9   4.6</span></span>
<span id="cb216-16"><a href="统计分析.html#cb216-16" aria-hidden="true" tabindex="-1"></a><span class="st">      14   F young    8.6   6.4</span></span>
<span id="cb216-17"><a href="统计分析.html#cb216-17" aria-hidden="true" tabindex="-1"></a><span class="st">      15   F young   14.3  13.5</span></span>
<span id="cb216-18"><a href="统计分析.html#cb216-18" aria-hidden="true" tabindex="-1"></a><span class="st">      16   F   old    9.2   4.7</span></span>
<span id="cb216-19"><a href="统计分析.html#cb216-19" aria-hidden="true" tabindex="-1"></a><span class="st">      17   M young    9.8   5.1</span></span>
<span id="cb216-20"><a href="统计分析.html#cb216-20" aria-hidden="true" tabindex="-1"></a><span class="st">      18   F   old    9.9   7.3</span></span>
<span id="cb216-21"><a href="统计分析.html#cb216-21" aria-hidden="true" tabindex="-1"></a><span class="st">      19   F young   13.0   9.5</span></span>
<span id="cb216-22"><a href="统计分析.html#cb216-22" aria-hidden="true" tabindex="-1"></a><span class="st">      20   M young   10.2   5.4</span></span>
<span id="cb216-23"><a href="统计分析.html#cb216-23" aria-hidden="true" tabindex="-1"></a><span class="st">      21   M young    9.0   3.7</span></span>
<span id="cb216-24"><a href="统计分析.html#cb216-24" aria-hidden="true" tabindex="-1"></a><span class="st">      22   F young    7.9   6.2</span></span>
<span id="cb216-25"><a href="统计分析.html#cb216-25" aria-hidden="true" tabindex="-1"></a><span class="st">      23   M   old   10.1  10.0</span></span>
<span id="cb216-26"><a href="统计分析.html#cb216-26" aria-hidden="true" tabindex="-1"></a><span class="st">      24   M young    9.0   1.7</span></span>
<span id="cb216-27"><a href="统计分析.html#cb216-27" aria-hidden="true" tabindex="-1"></a><span class="st">      25   M young    8.6   2.9</span></span>
<span id="cb216-28"><a href="统计分析.html#cb216-28" aria-hidden="true" tabindex="-1"></a><span class="st">      26   M young    9.4   3.2</span></span>
<span id="cb216-29"><a href="统计分析.html#cb216-29" aria-hidden="true" tabindex="-1"></a><span class="st">      27   M young    9.7   4.7</span></span>
<span id="cb216-30"><a href="统计分析.html#cb216-30" aria-hidden="true" tabindex="-1"></a><span class="st">      28   M young    9.3   4.9</span></span>
<span id="cb216-31"><a href="统计分析.html#cb216-31" aria-hidden="true" tabindex="-1"></a><span class="st">      29   F young   10.7   9.8</span></span>
<span id="cb216-32"><a href="统计分析.html#cb216-32" aria-hidden="true" tabindex="-1"></a><span class="st">      30   M   old    9.3   9.4</span></span>
<span id="cb216-33"><a href="统计分析.html#cb216-33" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;</span>)</span>
<span id="cb216-34"><a href="统计分析.html#cb216-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-35"><a href="统计分析.html#cb216-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 确保 subject</span></span>
<span id="cb216-36"><a href="统计分析.html#cb216-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 列是一个因子变量，这样不会当作连续变量对待</span></span>
<span id="cb216-37"><a href="统计分析.html#cb216-37" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>subject)</span></code></pre></div>
<div id="单因素-anova-分析" class="section level4" number="7.4.2.1">
<h4><span class="header-section-number">7.4.2.1</span> 单因素 ANOVA 分析</h4>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="统计分析.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 单因素： 独立变量: sex 依赖变量: before</span></span>
<span id="cb217-2"><a href="统计分析.html#cb217-2" aria-hidden="true" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(before <span class="sc">~</span> sex, <span class="at">data =</span> data)</span>
<span id="cb217-3"><a href="统计分析.html#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span>
<span id="cb217-4"><a href="统计分析.html#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb217-5"><a href="统计分析.html#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex          1    1.5    1.53    0.57   0.46</span></span>
<span id="cb217-6"><a href="统计分析.html#cb217-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals   28   74.7    2.67</span></span>
<span id="cb217-7"><a href="统计分析.html#cb217-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-8"><a href="统计分析.html#cb217-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示均值</span></span>
<span id="cb217-9"><a href="统计分析.html#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(aov1, <span class="st">&quot;means&quot;</span>)</span>
<span id="cb217-10"><a href="统计分析.html#cb217-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tables of means</span></span>
<span id="cb217-11"><a href="统计分析.html#cb217-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Grand mean</span></span>
<span id="cb217-12"><a href="统计分析.html#cb217-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       </span></span>
<span id="cb217-13"><a href="统计分析.html#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9.703 </span></span>
<span id="cb217-14"><a href="统计分析.html#cb217-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb217-15"><a href="统计分析.html#cb217-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  sex </span></span>
<span id="cb217-16"><a href="统计分析.html#cb217-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      F      M</span></span>
<span id="cb217-17"><a href="统计分析.html#cb217-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     10  9.532</span></span>
<span id="cb217-18"><a href="统计分析.html#cb217-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rep 11 19.000</span></span></code></pre></div>
</div>
<div id="双因素-anova-分析" class="section level4" number="7.4.2.2">
<h4><span class="header-section-number">7.4.2.2</span> 双因素 ANOVA 分析</h4>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="统计分析.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2x2: 独立变量: sex 独立变量: age 依赖变量: after</span></span>
<span id="cb218-2"><a href="统计分析.html#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 下面两种调用方式等价：</span></span>
<span id="cb218-3"><a href="统计分析.html#cb218-3" aria-hidden="true" tabindex="-1"></a>aov2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(after <span class="sc">~</span> sex <span class="sc">*</span> age, <span class="at">data =</span> data)</span>
<span id="cb218-4"><a href="统计分析.html#cb218-4" aria-hidden="true" tabindex="-1"></a>aov2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(after <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">+</span> sex<span class="sc">:</span>age, <span class="at">data =</span> data)</span>
<span id="cb218-5"><a href="统计分析.html#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov2)</span>
<span id="cb218-6"><a href="统计分析.html#cb218-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span id="cb218-7"><a href="统计分析.html#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex          1   16.1    16.1    4.04  0.0550 .  </span></span>
<span id="cb218-8"><a href="统计分析.html#cb218-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age          1   39.0    39.0    9.79  0.0043 ** </span></span>
<span id="cb218-9"><a href="统计分析.html#cb218-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex:age      1   89.6    89.6   22.51 6.6e-05 ***</span></span>
<span id="cb218-10"><a href="统计分析.html#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals   26  103.5     4.0                    </span></span>
<span id="cb218-11"><a href="统计分析.html#cb218-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb218-12"><a href="统计分析.html#cb218-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb218-13"><a href="统计分析.html#cb218-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb218-14"><a href="统计分析.html#cb218-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-15"><a href="统计分析.html#cb218-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示均值</span></span>
<span id="cb218-16"><a href="统计分析.html#cb218-16" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(aov2, <span class="st">&quot;means&quot;</span>)</span>
<span id="cb218-17"><a href="统计分析.html#cb218-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tables of means</span></span>
<span id="cb218-18"><a href="统计分析.html#cb218-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Grand mean</span></span>
<span id="cb218-19"><a href="统计分析.html#cb218-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       </span></span>
<span id="cb218-20"><a href="统计分析.html#cb218-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6.483 </span></span>
<span id="cb218-21"><a href="统计分析.html#cb218-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-22"><a href="统计分析.html#cb218-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  sex </span></span>
<span id="cb218-23"><a href="统计分析.html#cb218-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          F      M</span></span>
<span id="cb218-24"><a href="统计分析.html#cb218-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      7.445  5.926</span></span>
<span id="cb218-25"><a href="统计分析.html#cb218-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rep 11.000 19.000</span></span>
<span id="cb218-26"><a href="统计分析.html#cb218-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-27"><a href="统计分析.html#cb218-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  age </span></span>
<span id="cb218-28"><a href="统计分析.html#cb218-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        old  young</span></span>
<span id="cb218-29"><a href="统计分析.html#cb218-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      7.874  5.556</span></span>
<span id="cb218-30"><a href="统计分析.html#cb218-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rep 12.000 18.000</span></span>
<span id="cb218-31"><a href="统计分析.html#cb218-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb218-32"><a href="统计分析.html#cb218-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  sex:age </span></span>
<span id="cb218-33"><a href="统计分析.html#cb218-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      age</span></span>
<span id="cb218-34"><a href="统计分析.html#cb218-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sex   old    young </span></span>
<span id="cb218-35"><a href="统计分析.html#cb218-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   F    6.260  8.433</span></span>
<span id="cb218-36"><a href="统计分析.html#cb218-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rep  5.000  6.000</span></span>
<span id="cb218-37"><a href="统计分析.html#cb218-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   M    9.157  4.042</span></span>
<span id="cb218-38"><a href="统计分析.html#cb218-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rep  7.000 12.000</span></span></code></pre></div>
</div>
<div id="tukey-hsd-post-hoc-检验" class="section level4" number="7.4.2.3">
<h4><span class="header-section-number">7.4.2.3</span> Tukey HSD post-hoc 检验</h4>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="统计分析.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov2)</span>
<span id="cb219-2"><a href="统计分析.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Tukey multiple comparisons of means</span></span>
<span id="cb219-3"><a href="统计分析.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     95% family-wise confidence level</span></span>
<span id="cb219-4"><a href="统计分析.html#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-5"><a href="统计分析.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fit: aov(formula = after ~ sex + age + sex:age, data = data)</span></span>
<span id="cb219-6"><a href="统计分析.html#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-7"><a href="统计分析.html#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $sex</span></span>
<span id="cb219-8"><a href="统计分析.html#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       diff    lwr     upr p adj</span></span>
<span id="cb219-9"><a href="统计分析.html#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; M-F -1.519 -3.073 0.03475 0.055</span></span>
<span id="cb219-10"><a href="统计分析.html#cb219-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-11"><a href="统计分析.html#cb219-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $age</span></span>
<span id="cb219-12"><a href="统计分析.html#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             diff    lwr     upr  p adj</span></span>
<span id="cb219-13"><a href="统计分析.html#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; young-old -2.318 -3.846 -0.7893 0.0044</span></span>
<span id="cb219-14"><a href="统计分析.html#cb219-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb219-15"><a href="统计分析.html#cb219-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $`sex:age`</span></span>
<span id="cb219-16"><a href="统计分析.html#cb219-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    diff    lwr     upr  p adj</span></span>
<span id="cb219-17"><a href="统计分析.html#cb219-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; M:old-F:old      2.8971 -0.308  6.1022 0.0870</span></span>
<span id="cb219-18"><a href="统计分析.html#cb219-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F:young-F:old    2.1733 -1.141  5.4878 0.2966</span></span>
<span id="cb219-19"><a href="统计分析.html#cb219-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; M:young-F:old   -2.2183 -5.132  0.6953 0.1833</span></span>
<span id="cb219-20"><a href="统计分析.html#cb219-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F:young-M:old   -0.7238 -3.769  2.3215 0.9139</span></span>
<span id="cb219-21"><a href="统计分析.html#cb219-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; M:young-M:old   -5.1155 -7.719 -2.5122 0.0001</span></span>
<span id="cb219-22"><a href="统计分析.html#cb219-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; M:young-F:young -4.3917 -7.129 -1.6548 0.0009</span></span></code></pre></div>
</div>
</div>
<div id="有受试内变量的-anovas" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> 有受试内变量的 ANOVAs</h3>
<p>对于有受试内变量的 ANOVA 分析，数据必须满足为长格式。上面提到的数据都是宽格式，所以我们需要先转换数据格式（参见<a href="#section-6.17">长宽格式互相转换</a>）。</p>
<p>同样地，有受试内变量的 ANOVA 分析需要一个识别列。当前数据里是 <code>subject</code> 列。<strong>识别变量必须是一个因子</strong>，如果是数值类型，函数会解析错误导致不能正常工作。</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="统计分析.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb220-2"><a href="统计分析.html#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="统计分析.html#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 原始数据 subject sex age before after 1 F old 9.5</span></span>
<span id="cb220-4"><a href="统计分析.html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 7.1 2 M old 10.3 11.0 3 M old 7.5 5.8</span></span>
<span id="cb220-5"><a href="统计分析.html#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="统计分析.html#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换为长格式</span></span>
<span id="cb220-7"><a href="统计分析.html#cb220-7" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(data, time, value, before<span class="sc">:</span>after)</span>
<span id="cb220-8"><a href="统计分析.html#cb220-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at first few rows</span></span>
<span id="cb220-9"><a href="统计分析.html#cb220-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_long)</span>
<span id="cb220-10"><a href="统计分析.html#cb220-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   subject sex age   time value</span></span>
<span id="cb220-11"><a href="统计分析.html#cb220-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1   F old before   9.5</span></span>
<span id="cb220-12"><a href="统计分析.html#cb220-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       2   M old before  10.3</span></span>
<span id="cb220-13"><a href="统计分析.html#cb220-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       3   M old before   7.5</span></span>
<span id="cb220-14"><a href="统计分析.html#cb220-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4       4   F old before  12.4</span></span>
<span id="cb220-15"><a href="统计分析.html#cb220-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5       5   M old before  10.2</span></span>
<span id="cb220-16"><a href="统计分析.html#cb220-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6       6   M old before  11.0</span></span>
<span id="cb220-17"><a href="统计分析.html#cb220-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-18"><a href="统计分析.html#cb220-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 确保subject列是一个因子</span></span>
<span id="cb220-19"><a href="统计分析.html#cb220-19" aria-hidden="true" tabindex="-1"></a>data_long<span class="sc">$</span>subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_long<span class="sc">$</span>subject)</span></code></pre></div>
<div id="单因素被试内-anova" class="section level4" number="7.4.3.1">
<h4><span class="header-section-number">7.4.3.1</span> 单因素被试内 ANOVA</h4>
<p>首先，像上面展示的一样将数据从宽格式转换到长格式并确保 <code>subject</code> 列是因子变量。如果 <code>subject</code> 是数值向量，而不是因子，结果将会出错。</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="统计分析.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 独立变量 (被试内): time 依赖变量: value</span></span>
<span id="cb221-2"><a href="统计分析.html#cb221-2" aria-hidden="true" tabindex="-1"></a>aov_time <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> time <span class="sc">+</span> <span class="fu">Error</span>(subject<span class="sc">/</span>time), <span class="at">data =</span> data_long)</span>
<span id="cb221-3"><a href="统计分析.html#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_time)</span>
<span id="cb221-4"><a href="统计分析.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-5"><a href="统计分析.html#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: subject</span></span>
<span id="cb221-6"><a href="统计分析.html#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb221-7"><a href="统计分析.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 29    261    9.01               </span></span>
<span id="cb221-8"><a href="统计分析.html#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-9"><a href="统计分析.html#cb221-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: subject:time</span></span>
<span id="cb221-10"><a href="统计分析.html#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span id="cb221-11"><a href="统计分析.html#cb221-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time       1  155.5   155.5    71.4 2.6e-09 ***</span></span>
<span id="cb221-12"><a href="统计分析.html#cb221-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 29   63.1     2.2                    </span></span>
<span id="cb221-13"><a href="统计分析.html#cb221-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb221-14"><a href="统计分析.html#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb221-15"><a href="统计分析.html#cb221-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb221-16"><a href="统计分析.html#cb221-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-17"><a href="统计分析.html#cb221-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 因为一些原因，下面的代码不工作</span></span>
<span id="cb221-18"><a href="统计分析.html#cb221-18" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(aov_time, <span class="st">&quot;means&quot;</span>)</span>
<span id="cb221-19"><a href="统计分析.html#cb221-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tables of means</span></span>
<span id="cb221-20"><a href="统计分析.html#cb221-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Grand mean</span></span>
<span id="cb221-21"><a href="统计分析.html#cb221-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       </span></span>
<span id="cb221-22"><a href="统计分析.html#cb221-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8.093 </span></span>
<span id="cb221-23"><a href="统计分析.html#cb221-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb221-24"><a href="统计分析.html#cb221-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  time </span></span>
<span id="cb221-25"><a href="统计分析.html#cb221-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time</span></span>
<span id="cb221-26"><a href="统计分析.html#cb221-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  after before </span></span>
<span id="cb221-27"><a href="统计分析.html#cb221-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6.483  9.703</span></span></code></pre></div>
</div>
<div id="混合设计-anova" class="section level4" number="7.4.3.2">
<h4><span class="header-section-number">7.4.3.2</span> 混合设计 ANOVA</h4>
<p>首先，像上面展示的一样将数据从宽格式转换到长格式并确保 <code>subject</code> 列是因子变量。</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="统计分析.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2x2 mixed: 独立变量（被试间） : age</span></span>
<span id="cb222-2"><a href="统计分析.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 独立变量（被试内） : time 依赖变量: value</span></span>
<span id="cb222-3"><a href="统计分析.html#cb222-3" aria-hidden="true" tabindex="-1"></a>aov_age_time <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> age <span class="sc">*</span> time <span class="sc">+</span> <span class="fu">Error</span>(subject<span class="sc">/</span>time),</span>
<span id="cb222-4"><a href="统计分析.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_long)</span>
<span id="cb222-5"><a href="统计分析.html#cb222-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_age_time)</span>
<span id="cb222-6"><a href="统计分析.html#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb222-7"><a href="统计分析.html#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: subject</span></span>
<span id="cb222-8"><a href="统计分析.html#cb222-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span id="cb222-9"><a href="统计分析.html#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age        1   24.4   24.44    2.89    0.1</span></span>
<span id="cb222-10"><a href="统计分析.html#cb222-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 28  236.8    8.46               </span></span>
<span id="cb222-11"><a href="统计分析.html#cb222-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb222-12"><a href="统计分析.html#cb222-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Error: subject:time</span></span>
<span id="cb222-13"><a href="统计分析.html#cb222-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span id="cb222-14"><a href="统计分析.html#cb222-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; time       1  155.5   155.5    98.1 1.2e-10 ***</span></span>
<span id="cb222-15"><a href="统计分析.html#cb222-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age:time   1   18.8    18.8    11.8  0.0018 ** </span></span>
<span id="cb222-16"><a href="统计分析.html#cb222-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals 28   44.4     1.6                    </span></span>
<span id="cb222-17"><a href="统计分析.html#cb222-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb222-18"><a href="统计分析.html#cb222-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb222-19"><a href="统计分析.html#cb222-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb222-20"><a href="统计分析.html#cb222-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-21"><a href="统计分析.html#cb222-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 因为数据不平衡，下面代码不会工作</span></span>
<span id="cb222-22"><a href="统计分析.html#cb222-22" aria-hidden="true" tabindex="-1"></a><span class="fu">model.tables</span>(aov_age_time, <span class="st">&quot;means&quot;</span>)</span>
<span id="cb222-23"><a href="统计分析.html#cb222-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tables of means</span></span>
<span id="cb222-24"><a href="统计分析.html#cb222-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Grand mean</span></span>
<span id="cb222-25"><a href="统计分析.html#cb222-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       </span></span>
<span id="cb222-26"><a href="统计分析.html#cb222-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8.093 </span></span>
<span id="cb222-27"><a href="统计分析.html#cb222-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb222-28"><a href="统计分析.html#cb222-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  age </span></span>
<span id="cb222-29"><a href="统计分析.html#cb222-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        old  young</span></span>
<span id="cb222-30"><a href="统计分析.html#cb222-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      8.875  7.572</span></span>
<span id="cb222-31"><a href="统计分析.html#cb222-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rep 24.000 36.000</span></span>
<span id="cb222-32"><a href="统计分析.html#cb222-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb222-33"><a href="统计分析.html#cb222-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  time </span></span>
<span id="cb222-34"><a href="统计分析.html#cb222-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      after before</span></span>
<span id="cb222-35"><a href="统计分析.html#cb222-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      6.483  9.703</span></span>
<span id="cb222-36"><a href="统计分析.html#cb222-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rep 30.000 30.000</span></span>
<span id="cb222-37"><a href="统计分析.html#cb222-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb222-38"><a href="统计分析.html#cb222-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  age:time </span></span>
<span id="cb222-39"><a href="统计分析.html#cb222-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        time</span></span>
<span id="cb222-40"><a href="统计分析.html#cb222-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; age     after  before</span></span>
<span id="cb222-41"><a href="统计分析.html#cb222-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   old    7.950  9.800</span></span>
<span id="cb222-42"><a href="统计分析.html#cb222-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rep   12.000 12.000</span></span>
<span id="cb222-43"><a href="统计分析.html#cb222-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   young  5.506  9.639</span></span>
<span id="cb222-44"><a href="统计分析.html#cb222-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   rep   18.000 18.000</span></span></code></pre></div>
</div>
<div id="更多被试内变量的-anova" class="section level4" number="7.4.3.3">
<h4><span class="header-section-number">7.4.3.3</span> 更多被试内变量的 ANOVA</h4>
<p>下面这些例子使用的不是上面的数据，但可以解释怎么进行相应的处理。首先，像上面展示的一样将数据从宽格式转换到长格式并确保 <code>subject</code> 列是因子变量。</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="统计分析.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # 两个被试内变量 aov.ww &lt;- aov(y ~ w1*w2 +</span></span>
<span id="cb223-2"><a href="统计分析.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Error(subject/(w1*w2)), data=data_long) #</span></span>
<span id="cb223-3"><a href="统计分析.html#cb223-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1个被试间变量，两个被试内变量 aov.bww &lt;- aov(y ~</span></span>
<span id="cb223-4"><a href="统计分析.html#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># b1*w1*w2 + Error(subject/(w1*w2)) + b1,</span></span>
<span id="cb223-5"><a href="统计分析.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data=data_long) # 两个被试间变量，一个被试内变量</span></span>
<span id="cb223-6"><a href="统计分析.html#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="co"># aov.bww &lt;- aov(y ~ b1*b2*w1 + Error(subject/(w1)) +</span></span>
<span id="cb223-7"><a href="统计分析.html#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="co"># b1*b2, data=data_long)</span></span></code></pre></div>
</div>
</div>
</div>
<div id="逻辑回归" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> 逻辑回归</h2>
<div id="问题-47" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> 问题</h3>
<p>你想要运用逻辑回归分析。</p>
</div>
<div id="方案-46" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> 方案</h3>
<p>逻辑回归典型使用于当存在一个离散的响应变量（比如赢和输）和一个与响应变量（也称为结果变量、因变量）的概率或几率相关联的连续预测变量的情况。它也适用于有多个预测变量的分类预测。</p>
<p>假设我们从内置的 <code>mtcars</code> 数据集的一部分开始，像下面这样，我们将 <code>vs</code> 作为响应变量，<code>mpg</code> 作为一个连续的预测变量，<code>am</code> 作为一个分类（离散）的预测变量。</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="统计分析.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb224-2"><a href="统计分析.html#cb224-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">subset</span>(mtcars, <span class="at">select =</span> <span class="fu">c</span>(mpg, am, vs))</span>
<span id="cb224-3"><a href="统计分析.html#cb224-3" aria-hidden="true" tabindex="-1"></a>dat</span>
<span id="cb224-4"><a href="统计分析.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                      mpg am vs</span></span>
<span id="cb224-5"><a href="统计分析.html#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mazda RX4           21.0  1  0</span></span>
<span id="cb224-6"><a href="统计分析.html#cb224-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Mazda RX4 Wag       21.0  1  0</span></span>
<span id="cb224-7"><a href="统计分析.html#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Datsun 710          22.8  1  1</span></span>
<span id="cb224-8"><a href="统计分析.html#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hornet 4 Drive      21.4  0  1</span></span>
<span id="cb224-9"><a href="统计分析.html#cb224-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hornet Sportabout   18.7  0  0</span></span>
<span id="cb224-10"><a href="统计分析.html#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Valiant             18.1  0  1</span></span>
<span id="cb224-11"><a href="统计分析.html#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Duster 360          14.3  0  0</span></span>
<span id="cb224-12"><a href="统计分析.html#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 240D           24.4  0  1</span></span>
<span id="cb224-13"><a href="统计分析.html#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 230            22.8  0  1</span></span>
<span id="cb224-14"><a href="统计分析.html#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 280            19.2  0  1</span></span>
<span id="cb224-15"><a href="统计分析.html#cb224-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 280C           17.8  0  1</span></span>
<span id="cb224-16"><a href="统计分析.html#cb224-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 450SE          16.4  0  0</span></span>
<span id="cb224-17"><a href="统计分析.html#cb224-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 450SL          17.3  0  0</span></span>
<span id="cb224-18"><a href="统计分析.html#cb224-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Merc 450SLC         15.2  0  0</span></span>
<span id="cb224-19"><a href="统计分析.html#cb224-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cadillac Fleetwood  10.4  0  0</span></span>
<span id="cb224-20"><a href="统计分析.html#cb224-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lincoln Continental 10.4  0  0</span></span>
<span id="cb224-21"><a href="统计分析.html#cb224-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Chrysler Imperial   14.7  0  0</span></span>
<span id="cb224-22"><a href="统计分析.html#cb224-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fiat 128            32.4  1  1</span></span>
<span id="cb224-23"><a href="统计分析.html#cb224-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Honda Civic         30.4  1  1</span></span>
<span id="cb224-24"><a href="统计分析.html#cb224-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Toyota Corolla      33.9  1  1</span></span>
<span id="cb224-25"><a href="统计分析.html#cb224-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Toyota Corona       21.5  0  1</span></span>
<span id="cb224-26"><a href="统计分析.html#cb224-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dodge Challenger    15.5  0  0</span></span>
<span id="cb224-27"><a href="统计分析.html#cb224-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AMC Javelin         15.2  0  0</span></span>
<span id="cb224-28"><a href="统计分析.html#cb224-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Camaro Z28          13.3  0  0</span></span>
<span id="cb224-29"><a href="统计分析.html#cb224-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Pontiac Firebird    19.2  0  0</span></span>
<span id="cb224-30"><a href="统计分析.html#cb224-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fiat X1-9           27.3  1  1</span></span>
<span id="cb224-31"><a href="统计分析.html#cb224-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Porsche 914-2       26.0  1  0</span></span>
<span id="cb224-32"><a href="统计分析.html#cb224-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Lotus Europa        30.4  1  1</span></span>
<span id="cb224-33"><a href="统计分析.html#cb224-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Ford Pantera L      15.8  1  0</span></span>
<span id="cb224-34"><a href="统计分析.html#cb224-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Ferrari Dino        19.7  1  0</span></span>
<span id="cb224-35"><a href="统计分析.html#cb224-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maserati Bora       15.0  1  0</span></span>
<span id="cb224-36"><a href="统计分析.html#cb224-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Volvo 142E          21.4  1  1</span></span></code></pre></div>
<div id="连续预测变量离散响应变量" class="section level4" number="7.5.2.1">
<h4><span class="header-section-number">7.5.2.1</span> 连续预测变量，离散响应变量</h4>
<p>如果数据集有一个离散变量和一个连续变量，并且连续变量离散变量概率的预测器（就像直线回归中 x 可以预测 y 一样，只不过是两个连续变量，而逻辑回归中被预测的是离散变量），逻辑回归可能适用。</p>
<p>下面例子中，<code>mpg</code> 是连续预测变量，<code>vs</code> 是离散响应变量。.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="统计分析.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行逻辑回归 —— 下面两种方式等效</span></span>
<span id="cb225-2"><a href="统计分析.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># logit是二项分布家族的默认模型</span></span>
<span id="cb225-3"><a href="统计分析.html#cb225-3" aria-hidden="true" tabindex="-1"></a>logr_vm <span class="ot">&lt;-</span> <span class="fu">glm</span>(vs <span class="sc">~</span> mpg, <span class="at">data =</span> dat, <span class="at">family =</span> binomial)</span>
<span id="cb225-4"><a href="统计分析.html#cb225-4" aria-hidden="true" tabindex="-1"></a>logr_vm <span class="ot">&lt;-</span> <span class="fu">glm</span>(vs <span class="sc">~</span> mpg, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
<p>查看模型信息：</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="统计分析.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出模型信息</span></span>
<span id="cb226-2"><a href="统计分析.html#cb226-2" aria-hidden="true" tabindex="-1"></a>logr_vm</span>
<span id="cb226-3"><a href="统计分析.html#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-4"><a href="统计分析.html#cb226-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = vs ~ mpg, family = binomial(link = &quot;logit&quot;), data = dat)</span></span>
<span id="cb226-5"><a href="统计分析.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-6"><a href="统计分析.html#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb226-7"><a href="统计分析.html#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          mpg  </span></span>
<span id="cb226-8"><a href="统计分析.html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -8.83         0.43  </span></span>
<span id="cb226-9"><a href="统计分析.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-10"><a href="统计分析.html#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  30 Residual</span></span>
<span id="cb226-11"><a href="统计分析.html#cb226-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       43.9 </span></span>
<span id="cb226-12"><a href="统计分析.html#cb226-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 25.5  AIC: 29.5</span></span>
<span id="cb226-13"><a href="统计分析.html#cb226-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-14"><a href="统计分析.html#cb226-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总该模型的更多信息</span></span>
<span id="cb226-15"><a href="统计分析.html#cb226-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logr_vm)</span>
<span id="cb226-16"><a href="统计分析.html#cb226-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-17"><a href="统计分析.html#cb226-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb226-18"><a href="统计分析.html#cb226-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = vs ~ mpg, family = binomial(link = &quot;logit&quot;), data = dat)</span></span>
<span id="cb226-19"><a href="统计分析.html#cb226-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-20"><a href="统计分析.html#cb226-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb226-21"><a href="统计分析.html#cb226-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min      1Q  Median      3Q     Max  </span></span>
<span id="cb226-22"><a href="统计分析.html#cb226-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.213  -0.512  -0.228   0.640   1.698  </span></span>
<span id="cb226-23"><a href="统计分析.html#cb226-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-24"><a href="统计分析.html#cb226-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb226-25"><a href="统计分析.html#cb226-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span id="cb226-26"><a href="统计分析.html#cb226-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -8.833      3.162   -2.79   0.0052 **</span></span>
<span id="cb226-27"><a href="统计分析.html#cb226-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mpg            0.430      0.158    2.72   0.0066 **</span></span>
<span id="cb226-28"><a href="统计分析.html#cb226-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb226-29"><a href="统计分析.html#cb226-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb226-30"><a href="统计分析.html#cb226-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb226-31"><a href="统计分析.html#cb226-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-32"><a href="统计分析.html#cb226-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb226-33"><a href="统计分析.html#cb226-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-34"><a href="统计分析.html#cb226-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span></span>
<span id="cb226-35"><a href="统计分析.html#cb226-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 25.533  on 30  degrees of freedom</span></span>
<span id="cb226-36"><a href="统计分析.html#cb226-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 29.53</span></span>
<span id="cb226-37"><a href="统计分析.html#cb226-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb226-38"><a href="统计分析.html#cb226-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></span></code></pre></div>
<div id="画图" class="section level5" number="7.5.2.1.1">
<h5><span class="header-section-number">7.5.2.1.1</span> 画图</h5>
<p>我们可以使用 <strong>ggplot2</strong> 或者基本图形绘制数据和逻辑回归结果。</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="统计分析.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb227-2"><a href="统计分析.html#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> mpg, <span class="at">y =</span> vs)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb227-3"><a href="统计分析.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>), <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb227-4"><a href="统计分析.html#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-212-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="统计分析.html#cb228-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-2"><a href="统计分析.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 减少一些边缘使得图形显示更好些</span></span>
<span id="cb228-3"><a href="统计分析.html#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dat<span class="sc">$</span>mpg, dat<span class="sc">$</span>vs)</span>
<span id="cb228-4"><a href="统计分析.html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">predict</span>(logr_vm, <span class="fu">data.frame</span>(<span class="at">mpg =</span> x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),</span>
<span id="cb228-5"><a href="统计分析.html#cb228-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-212-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="离散预测变量离散响应变量" class="section level4" number="7.5.2.2">
<h4><span class="header-section-number">7.5.2.2</span> 离散预测变量，离散响应变量</h4>
<p>这个跟上面的操作大致相同，<code>am</code> 是一个离散的预测变量，<code>vs</code> 是一个离散的响应变量。</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="统计分析.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行逻辑回归</span></span>
<span id="cb229-2"><a href="统计分析.html#cb229-2" aria-hidden="true" tabindex="-1"></a>logr_va <span class="ot">&lt;-</span> <span class="fu">glm</span>(vs <span class="sc">~</span> am, <span class="at">data =</span> dat, <span class="at">family =</span> binomial)</span>
<span id="cb229-3"><a href="统计分析.html#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="统计分析.html#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印模型信息</span></span>
<span id="cb229-5"><a href="统计分析.html#cb229-5" aria-hidden="true" tabindex="-1"></a>logr_va</span>
<span id="cb229-6"><a href="统计分析.html#cb229-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-7"><a href="统计分析.html#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = vs ~ am, family = binomial, data = dat)</span></span>
<span id="cb229-8"><a href="统计分析.html#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-9"><a href="统计分析.html#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb229-10"><a href="统计分析.html#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)           am  </span></span>
<span id="cb229-11"><a href="统计分析.html#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      -0.539        0.693  </span></span>
<span id="cb229-12"><a href="统计分析.html#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-13"><a href="统计分析.html#cb229-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  30 Residual</span></span>
<span id="cb229-14"><a href="统计分析.html#cb229-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       43.9 </span></span>
<span id="cb229-15"><a href="统计分析.html#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 43    AIC: 47</span></span>
<span id="cb229-16"><a href="统计分析.html#cb229-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-17"><a href="统计分析.html#cb229-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总模型的信息</span></span>
<span id="cb229-18"><a href="统计分析.html#cb229-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logr_va)</span>
<span id="cb229-19"><a href="统计分析.html#cb229-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-20"><a href="统计分析.html#cb229-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb229-21"><a href="统计分析.html#cb229-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = vs ~ am, family = binomial, data = dat)</span></span>
<span id="cb229-22"><a href="统计分析.html#cb229-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-23"><a href="统计分析.html#cb229-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb229-24"><a href="统计分析.html#cb229-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min      1Q  Median      3Q     Max  </span></span>
<span id="cb229-25"><a href="统计分析.html#cb229-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.244  -0.959  -0.959   1.113   1.413  </span></span>
<span id="cb229-26"><a href="统计分析.html#cb229-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-27"><a href="统计分析.html#cb229-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb229-28"><a href="统计分析.html#cb229-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb229-29"><a href="统计分析.html#cb229-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   -0.539      0.476   -1.13     0.26</span></span>
<span id="cb229-30"><a href="统计分析.html#cb229-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; am             0.693      0.732    0.95     0.34</span></span>
<span id="cb229-31"><a href="统计分析.html#cb229-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-32"><a href="统计分析.html#cb229-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb229-33"><a href="统计分析.html#cb229-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-34"><a href="统计分析.html#cb229-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span></span>
<span id="cb229-35"><a href="统计分析.html#cb229-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 42.953  on 30  degrees of freedom</span></span>
<span id="cb229-36"><a href="统计分析.html#cb229-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 46.95</span></span>
<span id="cb229-37"><a href="统计分析.html#cb229-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb229-38"><a href="统计分析.html#cb229-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<div id="画图-1" class="section level5" number="7.5.2.2.1">
<h5><span class="header-section-number">7.5.2.2.1</span> 画图</h5>
<p>尽管图形可能会比连续预测变量的信息少，我们还是可以使用 <strong>ggplot2</strong> 或者基本图形绘制逻辑数据和回归结果。因为数据点大致在 4 个位置，我们可以使用抖动点避免叠加。</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="统计分析.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb230-2"><a href="统计分析.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> am, <span class="at">y =</span> vs)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>,</span>
<span id="cb230-3"><a href="统计分析.html#cb230-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.05</span>, <span class="at">height =</span> <span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb230-4"><a href="统计分析.html#cb230-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb230-5"><a href="统计分析.html#cb230-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="cn">FALSE</span>)</span>
<span id="cb230-6"><a href="统计分析.html#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-214-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="统计分析.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 减少一些边缘使得图形显示更好些</span></span>
<span id="cb231-2"><a href="统计分析.html#cb231-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">jitter</span>(dat<span class="sc">$</span>am, <span class="fl">0.2</span>), <span class="fu">jitter</span>(dat<span class="sc">$</span>vs, <span class="fl">0.2</span>))</span>
<span id="cb231-3"><a href="统计分析.html#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">predict</span>(logr_va, <span class="fu">data.frame</span>(<span class="at">am =</span> x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),</span>
<span id="cb231-4"><a href="统计分析.html#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-214-2.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="连续和离散预测变量离散响应变量" class="section level4" number="7.5.2.3">
<h4><span class="header-section-number">7.5.2.3</span> 连续和离散预测变量，离散响应变量</h4>
<p>这跟先前的例子相似，这里 <code>mpg</code> 是连续预测变量，<code>am</code> 是离散预测变量，<code>vs</code> 是离散响应变量。</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="统计分析.html#cb232-1" aria-hidden="true" tabindex="-1"></a>logr_vma <span class="ot">&lt;-</span> <span class="fu">glm</span>(vs <span class="sc">~</span> mpg <span class="sc">+</span> am, <span class="at">data =</span> dat, <span class="at">family =</span> binomial)</span>
<span id="cb232-2"><a href="统计分析.html#cb232-2" aria-hidden="true" tabindex="-1"></a>logr_vma</span>
<span id="cb232-3"><a href="统计分析.html#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-4"><a href="统计分析.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = vs ~ mpg + am, family = binomial, data = dat)</span></span>
<span id="cb232-5"><a href="统计分析.html#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-6"><a href="统计分析.html#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb232-7"><a href="统计分析.html#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          mpg           am  </span></span>
<span id="cb232-8"><a href="统计分析.html#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -12.705        0.681       -3.007  </span></span>
<span id="cb232-9"><a href="统计分析.html#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-10"><a href="统计分析.html#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  29 Residual</span></span>
<span id="cb232-11"><a href="统计分析.html#cb232-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       43.9 </span></span>
<span id="cb232-12"><a href="统计分析.html#cb232-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 20.6  AIC: 26.6</span></span>
<span id="cb232-13"><a href="统计分析.html#cb232-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-14"><a href="统计分析.html#cb232-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logr_vma)</span>
<span id="cb232-15"><a href="统计分析.html#cb232-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-16"><a href="统计分析.html#cb232-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb232-17"><a href="统计分析.html#cb232-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = vs ~ mpg + am, family = binomial, data = dat)</span></span>
<span id="cb232-18"><a href="统计分析.html#cb232-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-19"><a href="统计分析.html#cb232-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb232-20"><a href="统计分析.html#cb232-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb232-21"><a href="统计分析.html#cb232-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2.0589  -0.4454  -0.0876   0.3333   1.6841  </span></span>
<span id="cb232-22"><a href="统计分析.html#cb232-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-23"><a href="统计分析.html#cb232-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb232-24"><a href="统计分析.html#cb232-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span id="cb232-25"><a href="统计分析.html#cb232-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -12.705      4.625   -2.75    0.006 **</span></span>
<span id="cb232-26"><a href="统计分析.html#cb232-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mpg            0.681      0.252    2.70    0.007 **</span></span>
<span id="cb232-27"><a href="统计分析.html#cb232-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; am            -3.007      1.599   -1.88    0.060 . </span></span>
<span id="cb232-28"><a href="统计分析.html#cb232-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb232-29"><a href="统计分析.html#cb232-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb232-30"><a href="统计分析.html#cb232-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb232-31"><a href="统计分析.html#cb232-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-32"><a href="统计分析.html#cb232-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb232-33"><a href="统计分析.html#cb232-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-34"><a href="统计分析.html#cb232-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span></span>
<span id="cb232-35"><a href="统计分析.html#cb232-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 20.646  on 29  degrees of freedom</span></span>
<span id="cb232-36"><a href="统计分析.html#cb232-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 26.65</span></span>
<span id="cb232-37"><a href="统计分析.html#cb232-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb232-38"><a href="统计分析.html#cb232-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></span></code></pre></div>
</div>
<div id="有交互项的多个预测变量" class="section level4" number="7.5.2.4">
<h4><span class="header-section-number">7.5.2.4</span> 有交互项的多个预测变量</h4>
<p>当有多个预测变量时我们可能需要检验交互项。交互项可以单独指定，像 <code>a + b + c + a:b + b:c + a:b:c</code>，或者它们可以使用 <code>a * b *c</code> 自动展开（这两种等效）。如果只是想指定部分可能的交互项，比如 <code>a</code> 与 <code>c</code> 有交互项，使用 <code>a + b + c + a:c</code>。</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="统计分析.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行逻辑回归，下面两种方式等效</span></span>
<span id="cb233-2"><a href="统计分析.html#cb233-2" aria-hidden="true" tabindex="-1"></a>logr_vmai <span class="ot">&lt;-</span> <span class="fu">glm</span>(vs <span class="sc">~</span> mpg <span class="sc">*</span> am, <span class="at">data =</span> dat, <span class="at">family =</span> binomial)</span>
<span id="cb233-3"><a href="统计分析.html#cb233-3" aria-hidden="true" tabindex="-1"></a>logr_vmai <span class="ot">&lt;-</span> <span class="fu">glm</span>(vs <span class="sc">~</span> mpg <span class="sc">+</span> am <span class="sc">+</span> mpg<span class="sc">:</span>am, <span class="at">data =</span> dat, <span class="at">family =</span> binomial)</span>
<span id="cb233-4"><a href="统计分析.html#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="统计分析.html#cb233-5" aria-hidden="true" tabindex="-1"></a>logr_vmai</span>
<span id="cb233-6"><a href="统计分析.html#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-7"><a href="统计分析.html#cb233-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:  glm(formula = vs ~ mpg + am + mpg:am, family = binomial, data = dat)</span></span>
<span id="cb233-8"><a href="统计分析.html#cb233-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-9"><a href="统计分析.html#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb233-10"><a href="统计分析.html#cb233-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)          mpg           am       mpg:am  </span></span>
<span id="cb233-11"><a href="统计分析.html#cb233-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     -20.478        1.108       10.106       -0.664  </span></span>
<span id="cb233-12"><a href="统计分析.html#cb233-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-13"><a href="统计分析.html#cb233-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  28 Residual</span></span>
<span id="cb233-14"><a href="统计分析.html#cb233-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Null Deviance:       43.9 </span></span>
<span id="cb233-15"><a href="统计分析.html#cb233-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 19.1  AIC: 27.1</span></span>
<span id="cb233-16"><a href="统计分析.html#cb233-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-17"><a href="统计分析.html#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logr_vmai)</span>
<span id="cb233-18"><a href="统计分析.html#cb233-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-19"><a href="统计分析.html#cb233-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb233-20"><a href="统计分析.html#cb233-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; glm(formula = vs ~ mpg + am + mpg:am, family = binomial, data = dat)</span></span>
<span id="cb233-21"><a href="统计分析.html#cb233-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-22"><a href="统计分析.html#cb233-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb233-23"><a href="统计分析.html#cb233-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb233-24"><a href="统计分析.html#cb233-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.7057  -0.3112  -0.0482   0.2804   1.5560  </span></span>
<span id="cb233-25"><a href="统计分析.html#cb233-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-26"><a href="统计分析.html#cb233-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb233-27"><a href="统计分析.html#cb233-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span id="cb233-28"><a href="统计分析.html#cb233-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -20.478     10.553   -1.94    0.052 .</span></span>
<span id="cb233-29"><a href="统计分析.html#cb233-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mpg            1.108      0.577    1.92    0.055 .</span></span>
<span id="cb233-30"><a href="统计分析.html#cb233-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; am            10.106     11.910    0.85    0.396  </span></span>
<span id="cb233-31"><a href="统计分析.html#cb233-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mpg:am        -0.664      0.624   -1.06    0.288  </span></span>
<span id="cb233-32"><a href="统计分析.html#cb233-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb233-33"><a href="统计分析.html#cb233-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb233-34"><a href="统计分析.html#cb233-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb233-35"><a href="统计分析.html#cb233-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-36"><a href="统计分析.html#cb233-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb233-37"><a href="统计分析.html#cb233-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-38"><a href="统计分析.html#cb233-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span></span>
<span id="cb233-39"><a href="统计分析.html#cb233-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 19.125  on 28  degrees of freedom</span></span>
<span id="cb233-40"><a href="统计分析.html#cb233-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC: 27.12</span></span>
<span id="cb233-41"><a href="统计分析.html#cb233-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb233-42"><a href="统计分析.html#cb233-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 7</span></span></code></pre></div>
</div>
</div>
</div>
<div id="变量同质性" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> 变量同质性</h2>
<div id="问题-48" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> 问题</h3>
<p>你想要（精确）检验样本的方差同质性（同方差，方差齐性）。<strong>许多统计检验假设总体同方差</strong>。</p>
</div>
<div id="方案-47" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> 方案</h3>
<p>有许多检验方差同质性的方式，下面列出三种：</p>
<ul>
<li><strong>Bartlett’s test</strong> - 如果数据服从正态分布，这是最好地检验方法。该方法对非正态数据非常敏感，如果数据不是正态的很可能返回假阳性的结果。</li>
<li><strong>Levene’s test</strong> - 数据偏离正态性时比 Bartlett 检验更稳定（鲁棒性更好），内置于 <strong>car</strong> 包</li>
<li><strong>Fligner-Killeen test</strong> - 这是一个非参数检验，数据偏离正态是非常稳定适用。</li>
</ul>
<p>对于所有的检验，零假设为总体方差相同（同质；<strong>不是相等的意思</strong>）；备择假设是至少两组样本（总体方差）不同。</p>
<div id="样例数据-1" class="section level4" number="7.6.2.1">
<h4><span class="header-section-number">7.6.2.1</span> 样例数据</h4>
<p>这里的例子使用了 <code>InsectSprays</code> 和 <code>ToothGrowth</code> 数据集。<code>InsectSprays</code> 数据集有一个独立变量，而 <code>ToothGrowth</code> 数据集有两个独立变量。</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="统计分析.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(InsectSprays)</span>
<span id="cb234-2"><a href="统计分析.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   count spray</span></span>
<span id="cb234-3"><a href="统计分析.html#cb234-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    10     A</span></span>
<span id="cb234-4"><a href="统计分析.html#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     7     A</span></span>
<span id="cb234-5"><a href="统计分析.html#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    20     A</span></span>
<span id="cb234-6"><a href="统计分析.html#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    14     A</span></span>
<span id="cb234-7"><a href="统计分析.html#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    14     A</span></span>
<span id="cb234-8"><a href="统计分析.html#cb234-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    12     A</span></span>
<span id="cb234-9"><a href="统计分析.html#cb234-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-10"><a href="统计分析.html#cb234-10" aria-hidden="true" tabindex="-1"></a>tg <span class="ot">&lt;-</span> ToothGrowth</span>
<span id="cb234-11"><a href="统计分析.html#cb234-11" aria-hidden="true" tabindex="-1"></a>tg<span class="sc">$</span>dose <span class="ot">&lt;-</span> <span class="fu">factor</span>(tg<span class="sc">$</span>dose)  <span class="co"># Treat this column as a factor, not numeric</span></span>
<span id="cb234-12"><a href="统计分析.html#cb234-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tg)</span>
<span id="cb234-13"><a href="统计分析.html#cb234-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    len supp dose</span></span>
<span id="cb234-14"><a href="统计分析.html#cb234-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  4.2   VC  0.5</span></span>
<span id="cb234-15"><a href="统计分析.html#cb234-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 11.5   VC  0.5</span></span>
<span id="cb234-16"><a href="统计分析.html#cb234-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  7.3   VC  0.5</span></span>
<span id="cb234-17"><a href="统计分析.html#cb234-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  5.8   VC  0.5</span></span>
<span id="cb234-18"><a href="统计分析.html#cb234-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  6.4   VC  0.5</span></span>
<span id="cb234-19"><a href="统计分析.html#cb234-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6 10.0   VC  0.5</span></span></code></pre></div>
<p>快速绘制数据集的箱线图：</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="统计分析.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> InsectSprays)</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-218-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="统计分析.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(len <span class="sc">~</span> <span class="fu">interaction</span>(dose, supp), <span class="at">data =</span> ToothGrowth)</span></code></pre></div>
<p><img src="bookdown_files/figure-html/unnamed-chunk-219-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>初一看好像数据集的方差都不同质，但这需要像下面一样进行合适的检验。</p>
</div>
<div id="bartlett-检验" class="section level4" number="7.6.2.2">
<h4><span class="header-section-number">7.6.2.2</span> Bartlett 检验</h4>
<p>有一个独立变量：</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="统计分析.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> InsectSprays)</span>
<span id="cb237-2"><a href="统计分析.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb237-3"><a href="统计分析.html#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Bartlett test of homogeneity of variances</span></span>
<span id="cb237-4"><a href="统计分析.html#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb237-5"><a href="统计分析.html#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  count by spray</span></span>
<span id="cb237-6"><a href="统计分析.html#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bartlett&#39;s K-squared = 26, df = 5, p-value =</span></span>
<span id="cb237-7"><a href="统计分析.html#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9e-05</span></span></code></pre></div>
<p>有多个独立变量，必须使用 <code>interaction()</code> 函数将这些独立变量包裹为含所有因子组合的单个变量。如果不适应，那么会得到错误的自由度，因而 p 值也将是错误的。</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="统计分析.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(len <span class="sc">~</span> <span class="fu">interaction</span>(supp, dose), <span class="at">data =</span> ToothGrowth)</span>
<span id="cb238-2"><a href="统计分析.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb238-3"><a href="统计分析.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Bartlett test of homogeneity of variances</span></span>
<span id="cb238-4"><a href="统计分析.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb238-5"><a href="统计分析.html#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  len by interaction(supp, dose)</span></span>
<span id="cb238-6"><a href="统计分析.html#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bartlett&#39;s K-squared = 6.9, df = 5, p-value =</span></span>
<span id="cb238-7"><a href="统计分析.html#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.2</span></span>
<span id="cb238-8"><a href="统计分析.html#cb238-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-9"><a href="统计分析.html#cb238-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(len <span class="sc">~</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb238-10"><a href="统计分析.html#cb238-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb238-11"><a href="统计分析.html#cb238-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Bartlett test of homogeneity of variances</span></span>
<span id="cb238-12"><a href="统计分析.html#cb238-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb238-13"><a href="统计分析.html#cb238-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  len by dose</span></span>
<span id="cb238-14"><a href="统计分析.html#cb238-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bartlett&#39;s K-squared = 0.67, df = 2, p-value =</span></span>
<span id="cb238-15"><a href="统计分析.html#cb238-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.7</span></span></code></pre></div>
</div>
<div id="levene-检验" class="section level4" number="7.6.2.3">
<h4><span class="header-section-number">7.6.2.3</span> Levene 检验</h4>
<p><code>leveneTest()</code> 函数是 <strong>car</strong> 包的一部分。</p>
<p>有一个独立变量：</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="统计分析.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb239-2"><a href="统计分析.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 载入需要的程辑包：carData</span></span>
<span id="cb239-3"><a href="统计分析.html#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="统计分析.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> InsectSprays)</span>
<span id="cb239-5"><a href="统计分析.html#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levene&#39;s Test for Homogeneity of Variance (center = median)</span></span>
<span id="cb239-6"><a href="统计分析.html#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Df F value Pr(&gt;F)   </span></span>
<span id="cb239-7"><a href="统计分析.html#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; group  5    3.82 0.0042 **</span></span>
<span id="cb239-8"><a href="统计分析.html#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       66                  </span></span>
<span id="cb239-9"><a href="统计分析.html#cb239-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb239-10"><a href="统计分析.html#cb239-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb239-11"><a href="统计分析.html#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>有两个独立变量。注意这里 <code>interaction()</code> 函数不需要，因为该函数用于其他两个检验。</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="统计分析.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> tg)</span>
<span id="cb240-2"><a href="统计分析.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Levene&#39;s Test for Homogeneity of Variance (center = median)</span></span>
<span id="cb240-3"><a href="统计分析.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Df F value Pr(&gt;F)</span></span>
<span id="cb240-4"><a href="统计分析.html#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; group  5    1.71   0.15</span></span>
<span id="cb240-5"><a href="统计分析.html#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       54</span></span></code></pre></div>
</div>
<div id="fligner-killeen-检验" class="section level4" number="7.6.2.4">
<h4><span class="header-section-number">7.6.2.4</span> Fligner-Killeen 检验</h4>
<p>有一个独立变量：</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="统计分析.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(count <span class="sc">~</span> spray, <span class="at">data =</span> InsectSprays)</span>
<span id="cb241-2"><a href="统计分析.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb241-3"><a href="统计分析.html#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Fligner-Killeen test of homogeneity of</span></span>
<span id="cb241-4"><a href="统计分析.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variances</span></span>
<span id="cb241-5"><a href="统计分析.html#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb241-6"><a href="统计分析.html#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  count by spray</span></span>
<span id="cb241-7"><a href="统计分析.html#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fligner-Killeen:med chi-squared = 14, df = 5,</span></span>
<span id="cb241-8"><a href="统计分析.html#cb241-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value = 0.01</span></span></code></pre></div>
<p>当处理多个独立变量时，这个 <code>fligner.test()</code> 函数有跟 <code>bartlett.test()</code> 相同的行为。必须使用 <code>interaction()</code> 函数。</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="统计分析.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(len <span class="sc">~</span> <span class="fu">interaction</span>(supp, dose), <span class="at">data =</span> ToothGrowth)</span>
<span id="cb242-2"><a href="统计分析.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-3"><a href="统计分析.html#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Fligner-Killeen test of homogeneity of</span></span>
<span id="cb242-4"><a href="统计分析.html#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variances</span></span>
<span id="cb242-5"><a href="统计分析.html#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-6"><a href="统计分析.html#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  len by interaction(supp, dose)</span></span>
<span id="cb242-7"><a href="统计分析.html#cb242-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fligner-Killeen:med chi-squared = 7.7, df = 5,</span></span>
<span id="cb242-8"><a href="统计分析.html#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value = 0.2</span></span>
<span id="cb242-9"><a href="统计分析.html#cb242-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-10"><a href="统计分析.html#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fligner.test</span>(len <span class="sc">~</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb242-11"><a href="统计分析.html#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-12"><a href="统计分析.html#cb242-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Fligner-Killeen test of homogeneity of</span></span>
<span id="cb242-13"><a href="统计分析.html#cb242-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  variances</span></span>
<span id="cb242-14"><a href="统计分析.html#cb242-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb242-15"><a href="统计分析.html#cb242-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; data:  len by dose</span></span>
<span id="cb242-16"><a href="统计分析.html#cb242-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Fligner-Killeen:med chi-squared = 1.4, df = 2,</span></span>
<span id="cb242-17"><a href="统计分析.html#cb242-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; p-value = 0.5</span></span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="数据操作.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="标准绘图.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/openbiox/Cookbook-for-R-Chinese/edit/master/book/07-stats.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
